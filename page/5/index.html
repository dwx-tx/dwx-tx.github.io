<!DOCTYPE html>


<html lang="en">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> dwx-tx的小天地</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 
<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "https://hm.baidu.com/hm.js?57bee4bd4703d5af3f9154ce72c6f85f";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script>


      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="dwx-tx的小天地" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Shen-Yu/hexo-theme-ayer"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">dwx-tx的小天地</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-matlab矩阵运算"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/16/matlab%E7%9F%A9%E9%98%B5%E8%BF%90%E7%AE%97/"
    >矩阵运算</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/16/matlab%E7%9F%A9%E9%98%B5%E8%BF%90%E7%AE%97/" class="article-date">
  <time datetime="2022-03-16T00:05:47.175Z" itemprop="datePublished">2022-03-16</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="矩阵运算"><a href="#矩阵运算" class="headerlink" title="矩阵运算"></a>矩阵运算</h1><h2 id="矩阵"><a href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h2><h3 id="矩阵的建立"><a href="#矩阵的建立" class="headerlink" title="矩阵的建立"></a>矩阵的建立</h3><p>矩阵对的建立一般采用直接创建法</p>
<p><strong>注意：</strong></p>
<ul>
<li>输入矩阵时要以“[ ]”为其标识符号，矩阵的所有元素必须都在括号内。</li>
<li>矩阵同行元素之间由空格（个数不限）或逗号分隔，行与行之间用分号或者回车键分隔</li>
<li>矩阵的大小不需要预先定义</li>
<li>矩阵元素可以是运算表达式</li>
<li>若“[ ]”中无元素，表示空矩阵</li>
<li>如果不想显示中间结果，可以用”;”结束</li>
<li>MATLAB允许方括号里还有方括号</li>
</ul>
<h2 id="矩阵的生成"><a href="#矩阵的生成" class="headerlink" title="矩阵的生成"></a>矩阵的生成</h2><p>矩阵的生成两种方式：1.自己手打2.引入文件中的矩阵</p>
<p><strong>引入文件中矩阵的方法</strong>：通过load 文件名.格式 可以创建矩阵</p>
<p><strong>注意：这里的文件一定要在MATLAB运行文件中，要不然识别不了</strong></p>
<h2 id="几种创建特殊矩阵的方法"><a href="#几种创建特殊矩阵的方法" class="headerlink" title="几种创建特殊矩阵的方法"></a>几种创建特殊矩阵的方法</h2><table>
<thead>
<tr>
<th>函数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>eye(n)</td>
<td>创建nxn单位矩阵</td>
</tr>
<tr>
<td>eye(m,n)</td>
<td>创建mxn的单位矩阵</td>
</tr>
<tr>
<td>eye(size(A))</td>
<td>创建与A维度相同的单位阵</td>
</tr>
<tr>
<td>ones(n)</td>
<td>创建nxn全1矩阵</td>
</tr>
<tr>
<td>ones(m,n)</td>
<td>创建mxn全1矩阵</td>
</tr>
<tr>
<td>zeros(m,n)</td>
<td>创建mxn全0矩阵</td>
</tr>
<tr>
<td>zeros(size(A))</td>
<td>创建与A维度相同全0矩阵</td>
</tr>
<tr>
<td>rand(m)</td>
<td>在[0,1]区间内创建一个nxn均匀分布的随机矩阵</td>
</tr>
<tr>
<td>rand(mxn)</td>
<td>在[0,1]区间内创建一个mxn均匀分布的随机矩阵</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>函数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>rand(size(A))</td>
<td>在[0,1]区间内创建一个与A维度相同的均匀分布的随机矩阵</td>
</tr>
<tr>
<td>compan(P)</td>
<td>创建系数向量是P的多项式的伴随矩阵</td>
</tr>
<tr>
<td>diag(V)</td>
<td>创建一个以V中元素为主对角线的矩阵</td>
</tr>
<tr>
<td>hilb(n)</td>
<td>创建一个nxn的Hilbet矩阵</td>
</tr>
<tr>
<td>magic（n）</td>
<td>生成n阶魔方矩阵</td>
</tr>
<tr>
<td>sparse(A)</td>
<td>将矩阵A转化为系数矩阵</td>
</tr>
</tbody></table>
<h3 id="矩阵元素的运算"><a href="#矩阵元素的运算" class="headerlink" title="矩阵元素的运算"></a>矩阵元素的运算</h3><p><strong>矩阵元素的修改</strong></p>
<table>
<thead>
<tr>
<th>命令名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>D=[A;B C]</td>
<td>A为原矩阵，B、C中包含要扩充的元素，D为扩充后的矩阵</td>
</tr>
<tr>
<td>A(m,:)=[]</td>
<td>删除A的第m行</td>
</tr>
<tr>
<td>A(:,n)=[]</td>
<td>删除A的第n列</td>
</tr>
<tr>
<td>A(m,n) = a;A(m,:)=[a,b,…,n];A(:,n)=[a,b,c,…,n]</td>
<td>对A的第m行n列的元素赋值；对A的第m行赋值;对A的第n列赋值</td>
</tr>
</tbody></table>
<p><strong>矩阵的变维</strong></p>
<p>矩阵变维可以使用变维符号”:”,也可以使用reshape函数</p>
<p><strong>reshape(X,m,n)：</strong>表示将已知的矩阵X变成m行n列的矩阵</p>
<p><strong>矩阵的变向</strong></p>
<table>
<thead>
<tr>
<th>命令名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>rot(90)</td>
<td>将A逆时针方向旋转90°</td>
</tr>
<tr>
<td>rot(90,k)</td>
<td>将A逆时针方向旋转90°*k</td>
</tr>
<tr>
<td>fliplr(X)</td>
<td>将X左右翻转</td>
</tr>
<tr>
<td>flipud(X)</td>
<td>将X上下翻转</td>
</tr>
<tr>
<td>flipdim(X,dim)</td>
<td>dim=1时，对行翻转‘当dim=2时，对列翻转</td>
</tr>
</tbody></table>
<p><strong>矩阵的抽取</strong></p>
<table>
<thead>
<tr>
<th>命令名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>diag(X,k)</td>
<td>抽取矩阵X的第k条对角线上的元素向量。当k=0时是主对角线；当k&gt;0抽取主对角线上边的；当k&lt;0时抽取主对角线下边的</td>
</tr>
<tr>
<td>diag(X)</td>
<td>抽取主对角线</td>
</tr>
<tr>
<td>diag(v,k)</td>
<td>使v为所得矩阵第k条对角线上的元素向量</td>
</tr>
<tr>
<td>diag(v)</td>
<td>是v为所得矩阵主对角线上的元素向量</td>
</tr>
<tr>
<td>tril(X)</td>
<td>提取矩阵X的主下三角部分</td>
</tr>
<tr>
<td>tril(X,k)</td>
<td>提取矩阵X的第k条对角线下面的部分（包括第k条对角线）</td>
</tr>
<tr>
<td>triu(X)</td>
<td>提取矩阵X的主上三角部分</td>
</tr>
<tr>
<td>triu(X,k)</td>
<td>提取矩阵X的第k条对角线上面的部分（包括第k条对角线）</td>
</tr>
</tbody></table>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-matlab程序设计"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/16/matlab%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"
    >matlab程序设计</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/16/matlab%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/" class="article-date">
  <time datetime="2022-03-16T00:05:47.165Z" itemprop="datePublished">2022-03-16</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="matlab程序设计"><a href="#matlab程序设计" class="headerlink" title="matlab程序设计"></a>matlab程序设计</h1><p>matlab的关系操作符和逻辑操作符与C语言的一致，就不再做笔记</p>
<h2 id="控制流"><a href="#控制流" class="headerlink" title="控制流"></a>控制流</h2><p><strong>for 循环</strong></p>
<p><strong>一般形式</strong>:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x=array</span><br><span class="line">	&#123;commands&#125;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p><strong>while循环</strong>：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (expression)</span><br><span class="line">	&#123;commands&#125;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p><strong>if-else-end结构:</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (expression)</span><br><span class="line">	&#123;commands&#125;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-线性时间选择"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/15/%E7%BA%BF%E6%80%A7%E6%97%B6%E9%97%B4%E9%80%89%E6%8B%A9/"
    >线性时间选择</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/15/%E7%BA%BF%E6%80%A7%E6%97%B6%E9%97%B4%E9%80%89%E6%8B%A9/" class="article-date">
  <time datetime="2022-03-15T12:00:24.919Z" itemprop="datePublished">2022-03-15</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="线性时间选择"><a href="#线性时间选择" class="headerlink" title="线性时间选择"></a>线性时间选择</h1><p>选择一个无序整数列中的第i小</p>
<h2 id="基本思想"><a href="#基本思想" class="headerlink" title="基本思想"></a>基本思想</h2><p>利用快速排序的思想 因为快速排序特点是 每一次排序一定能够把一个值给确定位置，因此这里如果我们给确定位置的值和我们要找的值一样 那么我们成功了</p>
<h3 id="RandomSelect"><a href="#RandomSelect" class="headerlink" title="RandomSelect"></a>RandomSelect</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.passage2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomizedSelect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//正常来说 我们操作的都是整数数组</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> list[];</span><br><span class="line">    <span class="comment">//我们使用的是private私有对象 因此需要编写get/set方法来设置和获取值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] getList() &#123;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setList</span><span class="params">(<span class="keyword">int</span>[] list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//快速排序的思路是将第一个作为端点 但是我们这里使用一个随机数来获得端点</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    参数表：</span></span><br><span class="line"><span class="comment">    start：列表要查询的开始</span></span><br><span class="line"><span class="comment">    end：列表查询的结束</span></span><br><span class="line"><span class="comment">    find：我们要查询的第几小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">RandomizedSelect</span><span class="params">(<span class="keyword">int</span> start,<span class="keyword">int</span> end,<span class="keyword">int</span> find)</span></span>&#123;</span><br><span class="line">        <span class="comment">//编写程序结束程序</span></span><br><span class="line">        <span class="comment">//如果开始等于结束 我们没有什么课选的了 就选择到了合适的数据</span></span><br><span class="line">        <span class="keyword">if</span> (start==end)&#123;</span><br><span class="line">            <span class="comment">//这个就是我们找到的第几小的结果</span></span><br><span class="line">            <span class="keyword">return</span> list[start];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> i = RandomQuickSort(start,end);</span><br><span class="line">        <span class="comment">//比较我们得到的这个第几小和我们的目标小又什么区别</span></span><br><span class="line">        <span class="comment">//如果i大 则说明我们要找的find在划分后的后边</span></span><br><span class="line">        <span class="comment">//则将我们的起始地址设置为i+1,结束还是end，此时我们要找find-i小</span></span><br><span class="line">        <span class="comment">//注意 我们这里的j 因为 我们的start 不一定就是从零开始的 因此 我们选择后的第几小 就需要用find-j</span></span><br><span class="line">        <span class="keyword">int</span> j = i-start+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (find&lt;=j)&#123;</span><br><span class="line">            <span class="keyword">return</span> RandomizedSelect(start,i,find);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> RandomizedSelect(i+<span class="number">1</span>,end,find-j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//这个程序是对我们需要的list的一段进行一次快排 二我们快排的结果是随机的 通过random来获得我们的基准元素</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">RandomQuickSort</span><span class="params">(<span class="keyword">int</span> start,<span class="keyword">int</span> end)</span></span>&#123;</span><br><span class="line">        <span class="comment">//我们这里只需要一个开始和一个结束</span></span><br><span class="line">        <span class="comment">//获得一个随机数 在start和end之间</span></span><br><span class="line">        <span class="comment">//我们这里的随机数要设置好</span></span><br><span class="line">        <span class="keyword">int</span> n = (<span class="keyword">int</span>)(Math.random()*<span class="number">100</span>)%(end-start)+start;</span><br><span class="line">        System.out.println(<span class="string">&quot;这里我们将第&quot;</span>+n+<span class="string">&quot;个元素作为基准元素&quot;</span>);</span><br><span class="line">        <span class="comment">//将我们的基准元素存储起来</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> t = list[n];</span><br><span class="line">        list[n] = list[start];</span><br><span class="line">        list[start] = t;</span><br><span class="line">        <span class="keyword">int</span> i,j;</span><br><span class="line">        <span class="comment">//我们准备进行快排</span></span><br><span class="line">        i = start;</span><br><span class="line">        j = end;</span><br><span class="line">        <span class="comment">//快速排序的思想就是把比基准元素小的都放在左边</span></span><br><span class="line">        <span class="comment">//把比基准元素大的都放在右边 然后把基准元素归位</span></span><br><span class="line">        <span class="keyword">while</span> (i != j)&#123;</span><br><span class="line">            <span class="comment">//先让右哨兵动 找到合适数据后才停止</span></span><br><span class="line">            <span class="keyword">while</span> (list[j]&gt;=t &amp;&amp; j&gt;i)&#123;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//说明右哨兵已经选择好了 使左哨兵开始动</span></span><br><span class="line">            <span class="keyword">while</span> (list[i]&lt;=t &amp;&amp; i&lt;j)&#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//两个哨兵都找到了 交换数据</span></span><br><span class="line">            <span class="keyword">if</span> (i&lt;j) &#123;</span><br><span class="line">                <span class="keyword">int</span> temp = list[i];</span><br><span class="line">                list[i] = list[j];</span><br><span class="line">                list[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//将我们的基准元素放到合适的地方</span></span><br><span class="line">        list[start] = list[i];</span><br><span class="line">        list[i] = t;</span><br><span class="line">        <span class="comment">//我们找到的i就是我们这一次找到的目的元素所在的位置(即第几小)</span></span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>实现类：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.dwx.passage2.RandomizedSelect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomSelectTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RandomizedSelect select = <span class="keyword">new</span> RandomizedSelect();</span><br><span class="line">        <span class="comment">//选择我们的一个list</span></span><br><span class="line">        <span class="keyword">int</span>[] list = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">13</span>,<span class="number">45</span>,<span class="number">85</span>,<span class="number">63</span>,<span class="number">21</span>,<span class="number">54</span>,<span class="number">96</span>,<span class="number">35</span>,<span class="number">74</span>,<span class="number">84</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">5</span>&#125;;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;我们的无序数组的长度&quot;</span>+list.length);</span><br><span class="line">        select.setList(list);</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入我们要选择第几小:&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> find = scanner.nextInt();</span><br><span class="line">        <span class="keyword">int</span> i = select.RandomizedSelect(<span class="number">0</span>, list.length - <span class="number">1</span>, find);</span><br><span class="line">        System.out.println(<span class="string">&quot;我们找到的数据&quot;</span>+i);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;====================================&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i1 : list) &#123;</span><br><span class="line">            System.out.print(i1+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.println(<span class="string">&quot;====================================&quot;</span>);</span><br><span class="line">        <span class="comment">//这里设置一个简单排序来检测结果的正确性</span></span><br><span class="line">        <span class="keyword">int</span>[] query = query(list);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i1 : query) &#123;</span><br><span class="line">            System.out.print(i1+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.println(<span class="string">&quot;理论上我们的目标值&quot;</span>+list[find-<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//下边我们写一个冒泡排序 把我们的list进行一个排序 看看是否我们的答案和我们的找到的数据相同</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] query(<span class="keyword">int</span>[] list)&#123;</span><br><span class="line">        <span class="comment">//冒泡排序</span></span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">int</span> j;</span><br><span class="line">        <span class="keyword">int</span> temp;</span><br><span class="line">        <span class="comment">//冒泡排序的思想是 每次找到一个最小的放在应该最小的位置</span></span><br><span class="line">        <span class="keyword">int</span> min;</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;list.length;i++)&#123;</span><br><span class="line">            min = i;</span><br><span class="line">            <span class="keyword">for</span> (j=i;j&lt;list.length;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (list[j] &lt; list[min])&#123;</span><br><span class="line">                    <span class="comment">//记录找到的最小的数的下标</span></span><br><span class="line">                    min = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            if (i!=min) &#123;</span></span><br><span class="line">                temp = list[min];</span><br><span class="line">                list[min] = list[i];</span><br><span class="line">                list[i] = temp;</span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里我们还加装了一个一般排序来检测是否我们实现了</p>
<p>写这个算法真考研逻辑思维能力</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-棋盘覆盖问题"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/15/%E6%A3%8B%E7%9B%98%E8%A6%86%E7%9B%96%E9%97%AE%E9%A2%98/"
    >棋盘覆盖</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/15/%E6%A3%8B%E7%9B%98%E8%A6%86%E7%9B%96%E9%97%AE%E9%A2%98/" class="article-date">
  <time datetime="2022-03-15T11:59:51.597Z" itemprop="datePublished">2022-03-15</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="棋盘覆盖"><a href="#棋盘覆盖" class="headerlink" title="棋盘覆盖"></a>棋盘覆盖</h1><p>棋盘覆盖类似于一个游戏，在啊哈算法中我学到一个管道铺设问题，因此这里我们在介绍一个棋盘覆盖。</p>
<p>我认为这个棋盘覆盖是比管道铺设简单的，因为要铺设的几个方块的大小都是一样的。</p>
<h2 id="算法实现如下"><a href="#算法实现如下" class="headerlink" title="算法实现如下"></a>算法实现如下</h2><p>这里我们实现的递归算法</p>
<p><strong>算法程序</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.passage2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChessBoard</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里我们写一个二维整数数组</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> Board[][];</span><br><span class="line">    <span class="comment">//全局变量 表示</span></span><br><span class="line">    <span class="keyword">int</span> title = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBoard</span><span class="params">(<span class="keyword">int</span>[][] board)</span> </span>&#123;</span><br><span class="line">        Board = board;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[][] getBoard() &#123;</span><br><span class="line">        <span class="keyword">return</span> Board;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//我们使用的还是使用递归算法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChessBoard</span><span class="params">(<span class="keyword">int</span> tr, <span class="keyword">int</span> tc, <span class="keyword">int</span> dr, <span class="keyword">int</span> dc, <span class="keyword">int</span> size)</span></span>&#123;</span><br><span class="line">        <span class="comment">//这里 tr ,tc表示棋盘左上角的编号（行和列</span></span><br><span class="line">        <span class="comment">//dr dcr表示特殊方块所在的地方</span></span><br><span class="line">        <span class="comment">//size表示棋盘的大小</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//程序结束的条件 已经不能在分了</span></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//增加一个骨牌编号</span></span><br><span class="line">        <span class="keyword">int</span> t = title++;</span><br><span class="line">        <span class="keyword">int</span> s = size/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (dr&lt;tr+s &amp;&amp; dc &lt; tc+s)&#123;</span><br><span class="line">            <span class="comment">//说明特殊方块在七班左上角</span></span><br><span class="line">            ChessBoard(tr,tc,dr,dc,s);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//如果没在 则把左上角棋盘的左上角变成特殊棋盘</span></span><br><span class="line">            Board[tr+s-<span class="number">1</span>][tc+s-<span class="number">1</span>] = t;</span><br><span class="line">            ChessBoard(tr,tc,tr+s-<span class="number">1</span>,tc+s-<span class="number">1</span>,s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//同理 操作其他的三个子棋盘</span></span><br><span class="line">        <span class="comment">//这个是第</span></span><br><span class="line">        <span class="keyword">if</span> (dr&lt;tr+s &amp;&amp; dc &gt;= tc+s)&#123;</span><br><span class="line">            ChessBoard(tr,tc+s,dr,dc,s);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            Board[tr+s-<span class="number">1</span>][tc+s] = t;</span><br><span class="line">            ChessBoard(tr,tc+s,tr+s-<span class="number">1</span>,tc+s,s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dr&gt;=tr+s &amp;&amp; dc &lt; tc+s)&#123;</span><br><span class="line"></span><br><span class="line">            ChessBoard(tr+s,tc,dr,dc,s);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            Board[tr+s][tc+s-<span class="number">1</span>] = t;</span><br><span class="line">            ChessBoard(tr+s,tc,tr+s,tc+s-<span class="number">1</span>,s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dr&gt;=tr+s &amp;&amp; dc &gt;= tc+s)&#123;</span><br><span class="line"></span><br><span class="line">            ChessBoard(tr+s,tc+s,dr,dc,s);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            Board[tr+s][tc+s] = t;</span><br><span class="line">            ChessBoard(tr+s,tc+s,tr+s,tc+s,s);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>测试方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.dwx.passage2.ChessBoard;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoardTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//现在开一个4*4的二维整数数组</span></span><br><span class="line">        <span class="keyword">int</span>[][] board = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">        <span class="comment">//期初都是0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] ints : board) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> anInt : ints) &#123;</span><br><span class="line">                System.out.print(anInt+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//添加一个特殊方块 这里我们选择使用随机函数 我们把特殊方块设为9</span></span><br><span class="line">        <span class="comment">//产生o-3的随机数</span></span><br><span class="line">         <span class="keyword">int</span> x =  (<span class="keyword">int</span>)(Math.random()*<span class="number">10</span>)%<span class="number">4</span>;</span><br><span class="line">         <span class="keyword">int</span> y =  (<span class="keyword">int</span>)(Math.random()*<span class="number">10</span>)%<span class="number">4</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;特殊块的所在:&quot;</span>+<span class="string">&quot;(&quot;</span>+x+<span class="string">&quot;,&quot;</span>+y+<span class="string">&quot;)&quot;</span>);</span><br><span class="line">        board[x][y] = <span class="number">9</span>;</span><br><span class="line">        <span class="comment">//修改过的棋盘</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] ints : board) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> anInt : ints) &#123;</span><br><span class="line">                System.out.print(anInt+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//调用算法 填充棋盘</span></span><br><span class="line"></span><br><span class="line">        ChessBoard board1 = <span class="keyword">new</span> ChessBoard();</span><br><span class="line">        <span class="comment">//先把我们的目的board设置进去</span></span><br><span class="line">        board1.setBoard(board);</span><br><span class="line">        <span class="comment">//调用方法处理</span></span><br><span class="line">        board1.ChessBoard(<span class="number">0</span>,<span class="number">0</span>,x,y,<span class="number">4</span>);</span><br><span class="line">        <span class="comment">//获得调整过的board</span></span><br><span class="line">        <span class="keyword">int</span>[][] board2 = board1.getBoard();</span><br><span class="line">        System.out.println(<span class="string">&quot;==========结果=========&quot;</span>);</span><br><span class="line">        <span class="comment">//输出调整过的棋盘</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] ints : board2) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> anInt : ints) &#123;</span><br><span class="line">                System.out.print(anInt+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>结果</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	</span><br><span class="line"><span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	</span><br><span class="line"><span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	</span><br><span class="line"><span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	</span><br><span class="line">特殊块的所在:(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	</span><br><span class="line"><span class="number">0</span>	<span class="number">9</span>	<span class="number">0</span>	<span class="number">0</span>	</span><br><span class="line"><span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	</span><br><span class="line"><span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">0</span>	</span><br><span class="line">==========结果=========</span><br><span class="line"><span class="number">1</span>	<span class="number">1</span>	<span class="number">2</span>	<span class="number">2</span>	</span><br><span class="line"><span class="number">1</span>	<span class="number">9</span>	<span class="number">0</span>	<span class="number">2</span>	</span><br><span class="line"><span class="number">3</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">4</span>	</span><br><span class="line"><span class="number">3</span>	<span class="number">3</span>	<span class="number">4</span>	<span class="number">4</span>	</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-迪杰斯特拉算法"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/13/%E8%BF%AA%E6%9D%B0%E6%96%AF%E7%89%B9%E6%8B%89%E7%AE%97%E6%B3%95/"
    >迪杰斯特拉算法</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/13/%E8%BF%AA%E6%9D%B0%E6%96%AF%E7%89%B9%E6%8B%89%E7%AE%97%E6%B3%95/" class="article-date">
  <time datetime="2022-03-13T03:31:55.315Z" itemprop="datePublished">2022-03-13</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="迪杰斯特拉算法"><a href="#迪杰斯特拉算法" class="headerlink" title="迪杰斯特拉算法"></a>迪杰斯特拉算法</h1><p>今天在学习数学建模的时候发现 matlab实现迪杰斯特拉算法太麻烦了 想来想去还是通过C语言或者JAVA语言来实现这个算法最划算。</p>
<p><strong>算法特点：</strong>是来实现查看一个确定的点到其余各个顶点的最短路径问题。</p>
<h2 id="算法思想"><a href="#算法思想" class="headerlink" title="算法思想"></a>算法思想</h2><p>每次找到离源点最近的一个顶点，然后以该顶点为中心进行拓展，最终得到源点到其余各顶点的最短路径</p>
<p><strong>重要的概念：</strong>松弛，即如果1-&gt;3为43，但是1-&gt;2-&gt;3为13，那么我们就用第二个距离来表示1-&gt;3的距离</p>
<h2 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h2><ul>
<li>将所有的顶点分为两个部分，一直最短路程的顶点集合P和未知最短路径的顶点集合Q。使用一个数组Book【】来记录那些点是在集合P中，book[i]=1表示已经在集合中了0表示不在</li>
<li>设置源点s到自己的最短距离为0，即dis[s]=0,如果存在源点能够直接到的点，则设置为e<code>[ s ][ j ]</code>如果不是则设为无穷大（9999）</li>
<li>在集合中找到一个离源点最近的顶点，加入到集合p，并考察以此点到其他的的边并进行松弛操作</li>
<li>循环第三步 知道全部的点都进入到我们的book数组中</li>
</ul>
<h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><p><strong>使用JAVA语言，代码中有注释说明用途</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.passage2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dijkstar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] dis = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">int</span>[] book = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">int</span> i,j,n,u = <span class="number">0</span>,v,min;</span><br><span class="line">        <span class="keyword">int</span> inf = <span class="number">99999999</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> e[][] = <span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;</span><br><span class="line">                &#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">8</span>,inf,inf,inf,inf&#125;,</span><br><span class="line">                &#123;<span class="number">2</span>,<span class="number">0</span>,inf,<span class="number">6</span>,<span class="number">1</span>,inf,inf,inf&#125;,</span><br><span class="line">                &#123;<span class="number">1</span>,inf,<span class="number">0</span>,<span class="number">7</span>,inf,inf,<span class="number">9</span>,inf&#125;,</span><br><span class="line">                &#123;<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>,inf&#125;,</span><br><span class="line">                &#123;inf,<span class="number">1</span>,inf,<span class="number">5</span>,<span class="number">0</span>,<span class="number">3</span>,inf,<span class="number">9</span>&#125;,</span><br><span class="line">                &#123;inf,inf,inf,<span class="number">1</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">6</span>&#125;,</span><br><span class="line">                &#123;inf,inf,<span class="number">9</span>,<span class="number">2</span>,inf,<span class="number">4</span>,<span class="number">0</span>,<span class="number">3</span>&#125;,</span><br><span class="line">                &#123;inf,inf,inf,inf,<span class="number">9</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        n = e[<span class="number">0</span>].length-<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//初始化dis数组  这里是记录源点到其他各点的最短距离的</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            dis[i] = e[<span class="number">0</span>][i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//初始化book数组 book数组是记录已经被放入最短路径集合的点</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            book[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//将第一个点（源点）放入book数组中</span></span><br><span class="line">        book[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//Dijkstra算法的核心</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;=n-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            min = inf;</span><br><span class="line">            <span class="comment">//找到距离源点最短的点</span></span><br><span class="line">            <span class="keyword">for</span> (j=<span class="number">0</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (book[j] == <span class="number">0</span> &amp;&amp; dis[j]&lt;min)&#123;</span><br><span class="line">                    min = dis[j];</span><br><span class="line">                    u = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//将这个点读到book数组中</span></span><br><span class="line">            book[u] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (v=<span class="number">0</span>;v&lt;=n;v++)&#123;</span><br><span class="line">                <span class="comment">//收缩调整最短路径</span></span><br><span class="line">                <span class="keyword">if</span> (e[u][v] &lt; inf)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (dis[v]&gt;dis[u]+e[u][v])&#123;</span><br><span class="line">                        dis[v] = dis[u]+e[u][v];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> di : dis) &#123;</span><br><span class="line">            System.out.print(di+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.passage2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dijkstra</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[][] e = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">int</span>[] dis = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">int</span>[] book = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">int</span> i,j,n,m,t1,t2,t3,u = <span class="number">0</span>,v,min;</span><br><span class="line">        <span class="keyword">int</span> inf = <span class="number">99999999</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//这个操作是在实现存储图</span></span><br><span class="line">        <span class="comment">//读入顶点个数 和 边的条数</span></span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="comment">//n表示顶点个数 m表示边数</span></span><br><span class="line">        n = scanner.nextInt();</span><br><span class="line">        m = scanner.nextInt();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//初始化 将自己到自己的顶点为0 其他的全改为inf</span></span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (i == j)&#123;</span><br><span class="line">                    e[i][j] = <span class="number">0</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    e[i][j] = inf;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//读入边和权值</span></span><br><span class="line">        <span class="comment">//这里我们使用的是有向边</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= m;i++)&#123;</span><br><span class="line">            <span class="comment">//这里 t1表示起始的顶点 t2表示目标定点 t3表示权值</span></span><br><span class="line">            t1 = scanner.nextInt();</span><br><span class="line">            t2 = scanner.nextInt();</span><br><span class="line">            t3 = scanner.nextInt();</span><br><span class="line">            e[t1][t2] = t3;</span><br><span class="line">            <span class="comment">// e[t2][t1] = t3; //如果加上这一句话 就是在储存无向图</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//初始化dis数组  这里是记录源点到其他各点的最短距离的</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            dis[i] = e[<span class="number">1</span>][i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//初始化book数组 book数组是记录已经被放入最短路径集合的点</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            book[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//将第一个点（源点）放入book数组中</span></span><br><span class="line">        book[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//Dijkstra算法的核心</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            min = inf;</span><br><span class="line">            <span class="comment">//找到距离源点最短的点</span></span><br><span class="line">            <span class="keyword">for</span> (j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (book[j] == <span class="number">0</span> &amp;&amp; dis[j]&lt;min)&#123;</span><br><span class="line">                    min = dis[j];</span><br><span class="line">                    u = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//将这个点读到book数组中</span></span><br><span class="line">            book[u] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (v=<span class="number">1</span>;v&lt;=n;v++)&#123;</span><br><span class="line">                <span class="comment">//收缩调整最短路径</span></span><br><span class="line">                <span class="keyword">if</span> (e[u][v] &lt; inf)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (dis[v]&gt;dis[u]+e[u][v])&#123;</span><br><span class="line">                        dis[v] = dis[u]+e[u][v];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> di : dis) &#123;</span><br><span class="line">            System.out.print(di+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">**输入**</span><br><span class="line">    <span class="number">6</span> <span class="number">9</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">3</span> <span class="number">12</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">9</span></span><br><span class="line"><span class="number">2</span> <span class="number">4</span> <span class="number">3</span></span><br><span class="line"><span class="number">3</span> <span class="number">5</span> <span class="number">5</span></span><br><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="number">4</span> <span class="number">5</span> <span class="number">13</span></span><br><span class="line"><span class="number">4</span> <span class="number">6</span> <span class="number">16</span></span><br><span class="line"><span class="number">5</span> <span class="number">6</span> <span class="number">4</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-SpringMVC解决JSON乱码"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/05/SpringMVC%E8%A7%A3%E5%86%B3JSON%E4%B9%B1%E7%A0%81/"
    >SpringMVC解决JSON乱码</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/05/SpringMVC%E8%A7%A3%E5%86%B3JSON%E4%B9%B1%E7%A0%81/" class="article-date">
  <time datetime="2022-03-05T14:43:46.788Z" itemprop="datePublished">2022-03-05</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="SpringMVC解决JSON乱码"><a href="#SpringMVC解决JSON乱码" class="headerlink" title="SpringMVC解决JSON乱码"></a>SpringMVC解决JSON乱码</h1><p>在前后端的交互中可能会因为两者的编码类型不同而差生不同的乱码，正常情况下的乱码</p>
<h2 id="一般情况下的乱码"><a href="#一般情况下的乱码" class="headerlink" title="一般情况下的乱码"></a>一般情况下的乱码</h2><p>普通情况下的中文乱码是生僻字加符号的形式</p>
<p>这是解决乱码的方式是在Tomact上加上<code>-Dfile.encoding=UTF-8</code>在VM option中加</p>
<p>在web.xml中加上过滤器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="JSON乱码"><a href="#JSON乱码" class="headerlink" title="JSON乱码"></a>JSON乱码</h2><p>由于现在是前后盾分离时代，前后端的数据交互是通过JSON这种超文本形式进行的，因此JSON也可能出现中文乱码问题</p>
<p><strong>JSON乱码的特点：</strong>JSON乱码很有特点 是几个<code>????</code>组成的</p>
<p> <img src="https://s3.bmp.ovh/imgs/2022/03/81a4ae2a0d9cfb5c.jpg"> </p>
<p>JSON乱码在springMVC框架下的更改 只需要把RequestMapping修改成以下格式就行</p>
<p><code>@RequestMapping(value = &quot;enroll&quot;,produces = &quot;application/json;charset=utf-8&quot;)</code></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-编写过程"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/03/%E7%BC%96%E5%86%99%E8%BF%87%E7%A8%8B/"
    >编写软件的过程</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/03/%E7%BC%96%E5%86%99%E8%BF%87%E7%A8%8B/" class="article-date">
  <time datetime="2022-03-03T12:56:12.825Z" itemprop="datePublished">2022-03-03</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="编写软件的过程"><a href="#编写软件的过程" class="headerlink" title="编写软件的过程"></a>编写软件的过程</h1><h2 id="2022-2-23"><a href="#2022-2-23" class="headerlink" title="2022/2/23"></a>2022/2/23</h2><p>和胡振宇讨论了一下这个软件的大体内容，已经编写这个软件需求分析</p>
<h3 id="大致的步奏"><a href="#大致的步奏" class="headerlink" title="大致的步奏"></a>大致的步奏</h3><ul>
<li>上传数据</li>
<li>数据分析</li>
<li>生成文档</li>
</ul>
<h3 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h3><ul>
<li>数据库设置限制，有管理员能够修改数据</li>
<li>用户只需要填写表格 以及获得生成的最终表格 过程中的表格要管理员看</li>
</ul>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ul>
<li>是填写数据还是上传有格式的文档（填写一到表5）</li>
<li>生成表格是直接生成还是有一段时间后生成（自动封锁24h）</li>
<li>表格生成给谁？</li>
<li>这些表格之间的关系</li>
</ul>
<h3 id="时间要求"><a href="#时间要求" class="headerlink" title="时间要求"></a>时间要求</h3><p>今年年底</p>
<h2 id="2022-2-24"><a href="#2022-2-24" class="headerlink" title="2022/2/24"></a>2022/2/24</h2><h3 id="了解了一下Excel的读方法"><a href="#了解了一下Excel的读方法" class="headerlink" title="了解了一下Excel的读方法"></a>了解了一下Excel的读方法</h3><p>Excel的读取方法不同于正常的文件的读写，需要导入阿帕奇的poi的包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml-schemas<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>这边我做了一个简单的读取Excel文件的方法（这里是以.xlsx为尾缀的）</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadExlse</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//正常的文件类File无法读取Excel文件，需要使用Apache的包</span></span><br><span class="line">        <span class="comment">//Excel的全路径</span></span><br><span class="line">        String path = <span class="string">&quot;E:\\java\\filetest\\src\\main\\java\\com\\dwx\\file\\test.xlsx&quot;</span>;</span><br><span class="line">        File file = <span class="keyword">new</span> File(path);</span><br><span class="line">        System.out.println(file.isFile());</span><br><span class="line">        <span class="comment">//对文件进行操作 将文件转化成流</span></span><br><span class="line">        FileInputStream stream = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">        <span class="comment">//对这个文件流进行操作</span></span><br><span class="line">        <span class="comment">//创建这个Excel的对象</span></span><br><span class="line">        XSSFWorkbook sheets = <span class="keyword">new</span> XSSFWorkbook(stream);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取全部的sheets数</span></span><br><span class="line">        <span class="keyword">int</span> numberOfSheets = sheets.getNumberOfSheets();</span><br><span class="line">        System.out.println(<span class="string">&quot;================================================&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;此文件的所有表格数为：&quot;</span>+numberOfSheets);</span><br><span class="line">        System.out.println(<span class="string">&quot;================================================&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;numberOfSheets;k++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;这是第&quot;</span>+(k+<span class="number">1</span>)+<span class="string">&quot;个表格&quot;</span>);</span><br><span class="line">            XSSFSheet sheetAt = sheets.getSheetAt(k);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> firstRowNum = sheetAt.getFirstRowNum();</span><br><span class="line">            <span class="keyword">int</span> lastRowNum = sheetAt.getLastRowNum();</span><br><span class="line">            System.out.println(firstRowNum);</span><br><span class="line">            System.out.println(lastRowNum);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = firstRowNum; i &lt;= lastRowNum; i++) &#123;</span><br><span class="line">                XSSFRow row = sheetAt.getRow(i);</span><br><span class="line">             <span class="keyword">if</span> (row==<span class="keyword">null</span>)&#123;</span><br><span class="line">                 System.out.println(<span class="string">&quot;         &quot;</span>);</span><br><span class="line">                 <span class="keyword">continue</span>;</span><br><span class="line">             &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">short</span> lastCellNum = row.getLastCellNum();</span><br><span class="line">                <span class="keyword">short</span> firstCellNum = row.getFirstCellNum();</span><br><span class="line">               <span class="keyword">if</span> (lastCellNum &lt; <span class="number">0</span> || firstCellNum &lt; <span class="number">0</span>)&#123;</span><br><span class="line">                   <span class="keyword">continue</span>;</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = firstCellNum; j &lt;= lastCellNum; j++) &#123;</span><br><span class="line">                    XSSFCell cell = row.getCell(j);</span><br><span class="line">                    System.out.print(cell + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        sheets.close();</span><br><span class="line">        stream.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="了解了一下Excel的写的方法"><a href="#了解了一下Excel的写的方法" class="headerlink" title="了解了一下Excel的写的方法"></a>了解了一下Excel的写的方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WriteExlse</span> </span>&#123;</span><br><span class="line">    <span class="comment">//这个程序是一个写Excel的程序 面向的尾缀也是xlsx</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String fileName = <span class="string">&quot;C:\\Users\\Lenovo\\Desktop\\监审软件编译&quot;</span>+<span class="string">&quot;\\MyExlse&quot;</span>+<span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">        String sheetName = <span class="string">&quot;sheet01&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置一个sheets</span></span><br><span class="line">        XSSFWorkbook sheets = <span class="keyword">new</span> XSSFWorkbook();</span><br><span class="line">        <span class="comment">//设置第一个表的表格</span></span><br><span class="line">        <span class="comment">//设置第一个表的row数目</span></span><br><span class="line">        <span class="keyword">int</span> firstRowNumber = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> lastRowNumber = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">int</span> firstCellNumber = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> lastCellNumber = <span class="number">5</span>;</span><br><span class="line">        <span class="comment">//一个整个Excel文件创建一个表</span></span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line">        XSSFRow xssfRow;</span><br><span class="line">        XSSFCell xssfCell;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=firstRowNumber;i&lt;lastRowNumber;i++)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//表给某一行设置一个行</span></span><br><span class="line">            XSSFRow row = sheet.createRow(i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=firstCellNumber;j&lt;lastCellNumber;j++)&#123;</span><br><span class="line">                <span class="comment">//对这个行设置更多的cell（小室）</span></span><br><span class="line">                XSSFCell cell = row.createCell(j);</span><br><span class="line">                <span class="comment">//给这个cell（小室）设置值</span></span><br><span class="line">                cell.setCellValue(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//编写一个输出流</span></span><br><span class="line">        FileOutputStream stream = <span class="keyword">new</span> FileOutputStream(fileName);</span><br><span class="line">        <span class="comment">//把流写出去 一个sheets Excel表写出去</span></span><br><span class="line">        sheets.write(stream);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2022-2-26"><a href="#2022-2-26" class="headerlink" title="2022/2/26"></a>2022/2/26</h2><p>分析了数据库怎么建：选择创建链表的形式创建数据库</p>
<p>对用户的需求进行分析</p>
<h2 id="2022-2-27"><a href="#2022-2-27" class="headerlink" title="2022/2/27"></a>2022/2/27</h2><p>分析了应该去创建一个网站 我自己负责表格的编写工作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_fengmian</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setminban_fengmain</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置民办封面</span></span><br><span class="line">        <span class="comment">//创建一个sheet</span></span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(<span class="string">&quot;封面&quot;</span>);</span><br><span class="line">        <span class="comment">//封面的第一行是空着的</span></span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        XSSFRow xssfRow;</span><br><span class="line">        XSSFCell xssfCell;</span><br><span class="line">        <span class="comment">// 申请第一行 行和列都是从零开始的</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        <span class="comment">//第一行是四个cell</span></span><br><span class="line">        <span class="keyword">for</span> ( i = <span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">            XSSFCell cell = row.createCell(i);</span><br><span class="line">            <span class="comment">//第一行都是空着的 因此我们也把这个值设成空值</span></span><br><span class="line">            cell.setCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//下边编写第二行</span></span><br><span class="line">        <span class="comment">//第二行只用一列</span></span><br><span class="line">        <span class="comment">//设置单元格的合并</span></span><br><span class="line">        CellRangeAddress cellAddresses = <span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        XSSFCell cell = row1.createCell(<span class="number">0</span>);</span><br><span class="line">        cell.setCellValue(<span class="string">&quot;新乡市民办学校教育定价成本监审表&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//第三行是一个空格行</span></span><br><span class="line">        CellRangeAddress cellAddresses2 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses2);</span><br><span class="line">        XSSFRow row2 = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        XSSFCell cell1 = row2.createCell(<span class="number">0</span>);</span><br><span class="line">        cell1.setCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">//为第五后的合并单元格</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">3</span>;i&lt;=<span class="number">11</span>;i++)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses4 = <span class="keyword">new</span> CellRangeAddress(i, i, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses4);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//第五航到第12行</span></span><br><span class="line">        String[] name = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;学 校 名 称&quot;</span>,<span class="string">&quot;法 定人 代 表&quot;</span>,<span class="string">&quot;学 校 地 址&quot;</span>,<span class="string">&quot;邮 政 编 码&quot;</span>,<span class="string">&quot;财务负责人&quot;</span>,<span class="string">&quot;填  表  人&quot;</span>,<span class="string">&quot;电     话  &quot;</span>,<span class="string">&quot;邮     箱&quot;</span>,<span class="string">&quot;传     真 &quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">3</span>;i&lt;=<span class="number">11</span>; i++)&#123;</span><br><span class="line">            XSSFRow row4 = sheet.createRow(i);</span><br><span class="line">            XSSFCell cell4 = row4.createCell(<span class="number">1</span>);</span><br><span class="line">            cell4.setCellValue(name[i-<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//第十三行是空格行</span></span><br><span class="line">        sheet.createRow(<span class="number">12</span>);</span><br><span class="line">        <span class="comment">//第十四行</span></span><br><span class="line">        XSSFRow row3 = sheet.createRow(<span class="number">13</span>);</span><br><span class="line">        XSSFCell cell2 = row3.createCell(<span class="number">3</span>);</span><br><span class="line">        cell2.setCellValue(<span class="string">&quot;学校盖章&quot;</span>);</span><br><span class="line">        CellRangeAddress cellAddresses3 = <span class="keyword">new</span> CellRangeAddress(<span class="number">13</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses3);</span><br><span class="line">        <span class="comment">//第十五行</span></span><br><span class="line"></span><br><span class="line">        XSSFRow row4 = sheet.createRow(<span class="number">14</span>);</span><br><span class="line">        XSSFCell cell3 = row4.createCell(<span class="number">3</span>);</span><br><span class="line">        cell3.setCellValue(<span class="string">&quot;          年&quot;</span>);</span><br><span class="line"></span><br><span class="line">        XSSFCell cell4 = row4.createCell(<span class="number">4</span>);</span><br><span class="line">        cell4.setCellValue(<span class="string">&quot;     月           日&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//一下是对表格的宽度等的优化</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置列宽</span></span><br><span class="line"></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>, <span class="number">258</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">1</span>, <span class="number">258</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>, <span class="number">258</span>*<span class="number">13</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>, <span class="number">258</span>*<span class="number">13</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">5</span>, <span class="number">258</span>*<span class="number">28</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置行高</span></span><br><span class="line">        sheet.setDefaultRowHeight((<span class="keyword">short</span>) <span class="number">456</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>生成的第一个目标Excel，编写的格式和列宽和行高需要以后在改</p>
<h2 id="2022-2-28"><a href="#2022-2-28" class="headerlink" title="2022/2/28"></a>2022/2/28</h2><p>编写民办的第三张表 编写表的过程越来越快 现在平均2h能编好一张表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_biaoyi</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String sheetName = <span class="string">&quot;基本情况表1&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//编写第一行的内容</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        XSSFCell cell = row.createCell(<span class="number">0</span>);</span><br><span class="line">        cell.setCellValue(<span class="string">&quot;表：一&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//编写第二行的内容</span></span><br><span class="line">        <span class="comment">//第二行是从A到L有一个合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses = <span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">11</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        XSSFCell cell1 = row1.createCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cell1.setCellValue(<span class="string">&quot;XXX学校教育定价成本监审学生人数调查表&quot;</span>);</span><br><span class="line">        <span class="comment">//第三行也是一个大的合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses2 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">11</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses2);</span><br><span class="line">        XSSFRow row2 = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        XSSFCell cell2 = row2.createCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cell2.setCellValue(<span class="string">&quot;学校名称：（盖章）&quot;</span>);</span><br><span class="line">        <span class="comment">//第四五行有一个不规律的合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        CellRangeAddress cellAddresses6 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        CellRangeAddress cellAddresses3 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">8</span>);</span><br><span class="line">        CellRangeAddress cellAddresses4 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">9</span>);</span><br><span class="line">        CellRangeAddress cellAddresses5 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">        CellRangeAddress cellAddresses7 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">11</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses6);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses3);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses4);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses5);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses7);</span><br><span class="line">        <span class="comment">//又有一系列小的横向合并</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;<span class="number">8</span>;i=i+<span class="number">2</span>)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses8 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">3</span>, i, i + <span class="number">1</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses8);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//给第4、5行填值</span></span><br><span class="line"></span><br><span class="line">        XSSFRow row3 = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        row3.createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;项          目&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;栏次及关系&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">8</span>).setCellValue(<span class="string">&quot;总监审数&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;教育生均监审数&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;住宿生均监审数&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">11</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">6</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line"></span><br><span class="line">        XSSFRow row4 = sheet.createRow(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>;j&lt;=<span class="number">7</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row4.createCell(j).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row4.createCell(j).setCellValue(<span class="string">&quot;核定数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//对于表二 固定的值为两个列</span></span><br><span class="line">        <span class="comment">//使用数组的思路进行存值</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                     <span class="string">&quot;一、规模班数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、班人数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;小学（人/班&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;初中（人/班&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;高中（人/班&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、规模人数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;四、实际班级数（个）&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;五、实际在校平均标准学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）小学标准学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）初中标准学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）高中标准学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;六、实际在校平均住宿标准学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）小学标准住宿学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）初中标准住宿学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）高中标准住宿学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength,b;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        listLength = list1.length;</span><br><span class="line">        <span class="keyword">for</span> (b=<span class="number">0</span>;b&lt;listLength;b++)&#123;</span><br><span class="line">            XSSFRow row5 = sheet.createRow(b+<span class="number">5</span>);</span><br><span class="line">            row5.createCell(<span class="number">0</span>).setCellValue(list1[b]);</span><br><span class="line">            row5.createCell(<span class="number">1</span>).setCellValue(b+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//填充L列备注的填充</span></span><br><span class="line">        <span class="comment">//L列有几个单元格的合并</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">6</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">11</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">10</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">11</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">14</span>,<span class="number">16</span>,<span class="number">11</span>,<span class="number">11</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">18</span>,<span class="number">20</span>,<span class="number">11</span>,<span class="number">11</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">22</span>,<span class="number">30</span>,<span class="number">11</span>,<span class="number">11</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">32</span>,<span class="number">40</span>,<span class="number">11</span>,<span class="number">11</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//给备注填值</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> [] rowNumber = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">5</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">32</span>&#125;;</span><br><span class="line"></span><br><span class="line">        String[] rowValue = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;建校时可容纳班级数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2019-2020年填写“双减”前规模数；2021年按“双减”后规模数填写。&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;建校时每班人数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2019-2020年填写“双减”前规模数；2021年按“双减”后规模数填写。&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;规模人数=规模班数X班级人数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;纸质说明每个年级多少个班？&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;按实际在校学生人数填写，或按三年学籍人数纸质上报。&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;按实际在校住宿学生人数填写。&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> o=<span class="number">0</span>;o&lt;=<span class="number">7</span>;o++)&#123;</span><br><span class="line">            sheet.getRow(rowNumber[o]).createCell(<span class="number">11</span>).setCellValue(rowValue[o]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//内容填充部分已经全部填写完毕 开始设置表格的列宽</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">258</span>*<span class="number">36</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">1</span>,<span class="number">258</span>*<span class="number">22</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">11</span>,<span class="number">258</span>*<span class="number">66</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>我思考了一下问题，我可以通过添加一个set方法，来实现给每一张表中的数据进行填值</p>
<h2 id="2022-3-1"><a href="#2022-3-1" class="headerlink" title="2022/3/1"></a>2022/3/1</h2><p>编写了民办表基本情况表二</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_biaoer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建子表格 并且给其附上名字</span></span><br><span class="line">        String sheetName = <span class="string">&quot;基本情况表2&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//编写第一行的内容</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        XSSFCell cell = row.createCell(<span class="number">0</span>);</span><br><span class="line">        cell.setCellValue(<span class="string">&quot;表：二&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//编写第二行的内容</span></span><br><span class="line">        <span class="comment">//第二行是从A到L有一个合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses = <span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">11</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        XSSFCell cell1 = row1.createCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cell1.setCellValue(<span class="string">&quot;新乡市民办学校教育定价成本监审其它情况调查表&quot;</span>);</span><br><span class="line">        <span class="comment">//第三行也是一个大的合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses2 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">11</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses2);</span><br><span class="line">        XSSFRow row2 = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        XSSFCell cell2 = row2.createCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cell2.setCellValue(<span class="string">&quot;学校名称：（盖章）                                                                                                  单位：人&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//第四五行有一个不规律的合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        CellRangeAddress cellAddresses6 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        CellRangeAddress cellAddresses3 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">8</span>);</span><br><span class="line">        CellRangeAddress cellAddresses4 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">9</span>);</span><br><span class="line">        CellRangeAddress cellAddresses5 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">        CellRangeAddress cellAddresses7 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">11</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses6);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses3);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses4);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses5);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses7);</span><br><span class="line">        <span class="comment">//又有一系列小的横向合并</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;<span class="number">8</span>;i=i+<span class="number">2</span>)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses8 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">3</span>, i, i + <span class="number">1</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses8);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//给第4、5行填值</span></span><br><span class="line"></span><br><span class="line">        XSSFRow row3 = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        row3.createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;项          目&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;栏次及关系&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">8</span>).setCellValue(<span class="string">&quot;总监审数&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;教育生均监审数&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;住宿生均监审数&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">11</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">6</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line"></span><br><span class="line">        XSSFRow row4 = sheet.createRow(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>;j&lt;=<span class="number">7</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row4.createCell(j).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row4.createCell(j).setCellValue(<span class="string">&quot;核定数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String[] listC1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、教职工总数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）行政管理人数 &quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）小学教师人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）初中教师人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（四）高中教师人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（五）宿管人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（六）餐厅人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（七）其他辅助人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（八）临时人员 &quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、总建筑面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）教学建筑面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;共用建筑面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）住宿面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）餐厅面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、年收入&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;学费收入&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;餐厅收入&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其它收入&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;四、现执行收费标准&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        String[] listC10 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;指校长、学生科、教导处、会计室、维修人员等&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;保洁、保安和其它人员&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;低质说明从事什么岗位，工资如何发放。&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;指大门、厕所等共用设施&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;单位：元/生.年&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listC1Length = listC1.length;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;listC1Length;i++)&#123;</span><br><span class="line">            XSSFRow row5 = sheet.createRow(i + <span class="number">5</span>);</span><br><span class="line">            row5.createCell(<span class="number">0</span>).setCellValue(listC1[i]);</span><br><span class="line">            row5.createCell(<span class="number">1</span>).setCellValue(i+<span class="number">1</span>);</span><br><span class="line">            row5.createCell(<span class="number">11</span>).setCellValue(listC10[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//内容填充部分已经全部填写完毕 开始设置表格的列宽</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">258</span>*<span class="number">36</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">1</span>,<span class="number">258</span>*<span class="number">22</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">11</span>,<span class="number">258</span>*<span class="number">66</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>表三编写成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_biaosan</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建的子表格的名字</span></span><br><span class="line">        String sheetName = <span class="string">&quot;三年审计报告表3&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//编写第一行的内容</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        XSSFCell cell = row.createCell(<span class="number">0</span>);</span><br><span class="line">        cell.setCellValue(<span class="string">&quot;表三&quot;</span>);</span><br><span class="line">        <span class="comment">//编写第二行的内容</span></span><br><span class="line">        <span class="comment">//第二行是从A到L有一个合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses = <span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        XSSFCell cell1 = row1.createCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cell1.setCellValue(<span class="string">&quot;新乡市xxx学校审计数基本情况表&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//第四五行有一个不规律的合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        CellRangeAddress cellAddresses2 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//又有一系列小的横向合并</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">9</span>;i=i+<span class="number">3</span>)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses8 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">2</span>, i, i + <span class="number">2</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses8);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//给第4、5行填值</span></span><br><span class="line"></span><br><span class="line">        XSSFRow row3 = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        row3.createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        row3.createCell(<span class="number">1</span>).setCellValue(<span class="number">2019</span>);</span><br><span class="line">        row3.createCell(<span class="number">4</span>).setCellValue(<span class="number">2020</span>);</span><br><span class="line">        row3.createCell(<span class="number">7</span>).setCellValue(<span class="number">2021</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        XSSFRow row2 = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j&lt;=<span class="number">9</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row2.createCell(j).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">2</span>)&#123;</span><br><span class="line">                row2.createCell(j).setCellValue(<span class="string">&quot;核增核减数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row2.createCell(j).setCellValue(<span class="string">&quot;审计数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        row3.createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//第一列的所有数据</span></span><br><span class="line">        String[] listC1  = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">            <span class="string">&quot;一、人员支出&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;1、行政和其它人员&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;2、教师&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;3、宿管人员&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;4、社会保障费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;5、福利费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（一）小学人员支出&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;1、行政和其它人员&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;2、教师&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;3、宿管人员&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;4、社会保障费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;5、福利费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（二）初中人员支出&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;1、行政和其它人员&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;2、教师&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;3、宿管人员&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;4、社会保障费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;5、福利费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（三）高中人员支出&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;1、行政和其它人员&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;2、教师&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;3、宿管人员&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;4、社会保障费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;5、福利费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;二、租赁费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（一）小学租赁费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;小学教学&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;小学住宿&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（二）初中租赁费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;初中教学&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;初中住宿&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（三）高中租赁费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;高中教学&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;高中住宿&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;三、财务费用&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（一）小学财务费用&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;小学教学&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;小学住宿&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（二）初中财务费用&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;初中教学&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;初中住宿&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;（三）高中财务费用&quot;</span> ,                    <span class="string">&quot;高中教学\n&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;高中住宿&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;四、公用支出&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;1、办公费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;2、水电费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;3、维修费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;4、职工教育经费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;5、工会经费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;6、招待费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;7、交通费&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;8、&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;9、&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;10、&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;11、&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;12、&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;13、&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;14、&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;15、其它费用&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;五、合计&quot;</span> ,</span><br><span class="line">                    <span class="string">&quot;六、固定资产原值&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listNumber = listC1.length;</span><br><span class="line">        <span class="keyword">int</span> i ;</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;listNumber;i++)&#123;</span><br><span class="line">            XSSFRow row5 = sheet.createRow(i + <span class="number">4</span>);</span><br><span class="line">            row5.createCell(<span class="number">0</span>).setCellValue(listC1[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置第K列的数据 K列有很多的合并单元格先合并单元格</span></span><br><span class="line">        <span class="keyword">int</span>[] list1 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">10</span>,<span class="number">29</span>,<span class="number">39</span>,<span class="number">48</span>&#125;;</span><br><span class="line">        <span class="keyword">int</span>[] list2 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">17</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">15</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses3 = <span class="keyword">new</span> CellRangeAddress(list1[j],list1[j]+list2[j], <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses3);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//为底k列设值</span></span><br><span class="line">        <span class="keyword">int</span>[] list3 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">10</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">38</span>,<span class="number">39</span>,<span class="number">48</span>,<span class="number">64</span>,<span class="number">65</span>&#125;;</span><br><span class="line">        <span class="comment">//设置值</span></span><br><span class="line">        String[] listK = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;提供2021全体人员工资发放表&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;提供三年租赁合同&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;按建筑面积比或学生比分摊&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;提供金融机构贷款合同&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;按建筑面积比或学生比分摊&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;根据审计报告科目，可增加科目或另行加行。&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;和审计报告数是否一致？&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;和审计报告数一致&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>;i&lt;=<span class="number">7</span>;i++)&#123;</span><br><span class="line">            sheet.getRow(list3[i]).createCell(<span class="number">10</span>).setCellValue(listK[i]);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//设置表格宽</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">32</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">10</span>,<span class="number">256</span>*<span class="number">30</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>表四编写成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_biaosi</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        String sheetName = <span class="string">&quot;固定资产表4&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line">        <span class="comment">//编写第一行</span></span><br><span class="line">        <span class="comment">//编写第一行的内容</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        XSSFCell cell = row.createCell(<span class="number">0</span>);</span><br><span class="line">        cell.setCellValue(<span class="string">&quot;表四&quot;</span>);</span><br><span class="line">        <span class="comment">//编写第二行的内容</span></span><br><span class="line">        <span class="comment">//第二行是从A到L有一个合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses = <span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        XSSFCell cell1 = row1.createCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cell1.setCellValue(<span class="string">&quot;XXX学校2021年度固定资产折旧核定表&quot;</span>);</span><br><span class="line">        <span class="comment">//第三行是从A到L有一个合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        XSSFRow row2 = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        XSSFCell cell2 = row2.createCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cell2.setCellValue(<span class="string">&quot;单位名称：（盖章）                                                                                                残值率：3%                     单位：元&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//编写第四行的内容</span></span><br><span class="line">        String[] list4 = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;项 目&quot;</span>,<span class="string">&quot;栏次及关系&quot;</span>,<span class="string">&quot;原值&quot;</span>,<span class="string">&quot;教学原值&quot;</span>,<span class="string">&quot;公用支出核转&quot;</span>,<span class="string">&quot;宿舍原值&quot;</span>,<span class="string">&quot;餐厅原值&quot;</span>,<span class="string">&quot;折旧年限&quot;</span>,<span class="string">&quot;教学年折旧&quot;</span>,<span class="string">&quot;宿舍年折旧&quot;</span>,<span class="string">&quot;备注&quot;</span>&#125;;</span><br><span class="line">        <span class="comment">//给第四行填值</span></span><br><span class="line">        XSSFRow row3 = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">11</span>;i++) &#123;</span><br><span class="line">            row3.createCell(i).setCellValue(list4[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//第一列是一个有规律的列 给其添值</span></span><br><span class="line">        String[] list5 = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;一、房屋建筑物&quot;</span>,</span><br><span class="line">                <span class="string">&quot;1、钢结构混凝土结构&quot;</span> ,</span><br><span class="line">                <span class="string">&quot;2、砖混结构&quot;</span> ,</span><br><span class="line">                <span class="string">&quot;3、房屋附属物和构筑物&quot;</span> ,</span><br><span class="line">                <span class="string">&quot;二、通用设备&quot;</span> ,</span><br><span class="line">                <span class="string">&quot;三、专用设备&quot;</span> ,</span><br><span class="line">                <span class="string">&quot;四、家具&quot;</span> ,</span><br><span class="line">                <span class="string">&quot;五、土地&quot;</span> ,</span><br><span class="line">                <span class="string">&quot;六、合计&quot;</span> ,</span><br><span class="line">                <span class="string">&quot;七、预增固定资产&quot;</span>,</span><br><span class="line">                <span class="string">&quot;八、合计&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt;=<span class="number">10</span>;j++)&#123;</span><br><span class="line">            sheet.createRow(j+<span class="number">4</span>).createCell(<span class="number">0</span>).setCellValue(list5[j]);</span><br><span class="line">            sheet.getRow(j+<span class="number">4</span>).createCell(<span class="number">1</span>).setCellValue(j+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        sheet.getRow(<span class="number">11</span>).createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;购地合同&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">12</span>).createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;C13和审计报告数是否一致？&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建倒数第二行 一个大的合并</span></span><br><span class="line">        CellRangeAddress cellAddresses2 = <span class="keyword">new</span> CellRangeAddress(<span class="number">15</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">        CellRangeAddress cellAddresses3 = <span class="keyword">new</span> CellRangeAddress(<span class="number">16</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">6</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses2);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses3);</span><br><span class="line">        <span class="comment">//设值</span></span><br><span class="line">        sheet.createRow(<span class="number">15</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;1、通用设备包括计算机、网络设备、安全设备、终端设备、存储设备、电话机、传真机、复印机、投影仪、多功能一体机、车辆、音像设备、电子白板、LED显示屏、触控一体机、图书等；2、专用设备包括电梯、制冷空调、锅炉、空气能、后续安装的电机、变压器、电源设备、直饮供水设备、乐器、舞台设备、多功能厅设备、田径设备、球类设备、体育运动辅助设备等。&quot;</span>);</span><br><span class="line">        sheet.createRow(<span class="number">16</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;填表说明：加黄线的不要填写，更不要更改公式&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置表格宽度</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">32</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">10</span>,<span class="number">256</span>*<span class="number">35</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>表五编写成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_biaowu</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        String sheetName = <span class="string">&quot;三年账册相关科目表5&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line">        <span class="comment">//编写第一行</span></span><br><span class="line">        <span class="comment">//编写第一行的内容</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        XSSFCell cell = row.createCell(<span class="number">0</span>);</span><br><span class="line">        cell.setCellValue(<span class="string">&quot;表五&quot;</span>);</span><br><span class="line">        <span class="comment">//第二行是从A到L有一个合并单元格</span></span><br><span class="line">        CellRangeAddress cellAddresses = <span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        XSSFCell cell1 = row1.createCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cell1.setCellValue(<span class="string">&quot;新乡市xxx学校账册基本情况调查表&quot;</span>);</span><br><span class="line">        <span class="comment">//第三行是从A到L有一个合并单元格</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//第思维航的第一个合并列</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">        <span class="comment">//又有一系列小的横向合并</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">6</span>;i=i+<span class="number">3</span>)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">2</span>, i+<span class="number">1</span>, i+<span class="number">3</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//添值</span></span><br><span class="line">        sheet.createRow(<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;科目&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">7</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line">        XSSFRow row4 = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j&lt;=<span class="number">9</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row4.createCell(j).setCellValue(<span class="string">&quot;凭证类型&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">2</span>)&#123;</span><br><span class="line">                row4.createCell(j).setCellValue(<span class="string">&quot;账册号&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row4.createCell(j).setCellValue(<span class="string">&quot;金额&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        row4.createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//对第一列进行添值</span></span><br><span class="line">        String[] listC1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、维修费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、低值易耗品&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、其它支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;四、财务费用&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>;i&lt;=<span class="number">23</span>;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">4</span>).createCell(<span class="number">0</span>).setCellValue(listC1[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//备注行有很多的合并单元格 这些单元格的合并都是五行</span></span><br><span class="line">        <span class="keyword">int</span>[] list1 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">4</span>,<span class="number">10</span>,<span class="number">16</span>,<span class="number">22</span>&#125;;</span><br><span class="line">        String[] list2 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;1、统计大于该科目金额20%的明细。2、凭证类型填写发票、合同（协议）、白条（收据）&quot;</span> ,</span><br><span class="line"></span><br><span class="line">                        <span class="string">&quot;1、统计大于该科目金额20%的明细。2、凭证类型填写发票、合同（协议）、白条（收据）&quot;</span> ,</span><br><span class="line"></span><br><span class="line">                        <span class="string">&quot;1、如果金额大于公用支出20%，请按内容分类。 如果金额小于公用支出20%，不填写。2、凭证类型填写发票、合同（协议）、白条（收据）&quot;</span> ,</span><br><span class="line"></span><br><span class="line">                        <span class="string">&quot;1、统计还款利息。2、凭证类型填写发票、合同（协议）、白条（收据）.&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>;i&lt;=<span class="number">3</span>;i++)&#123;</span><br><span class="line">            sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(list1[i],list1[i]+<span class="number">5</span>,<span class="number">10</span>,<span class="number">10</span>));</span><br><span class="line">            sheet.getRow(list1[i]).createCell(<span class="number">10</span>).setCellValue(list2[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置列表的行宽</span></span><br><span class="line"></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">17</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">10</span>,<span class="number">256</span>*<span class="number">66</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2022-3-2"><a href="#2022-3-2" class="headerlink" title="2022/3/2"></a>2022/3/2</h2><p>民办表编写结束</p>
<p>教育参数表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_jiaoyuhesuanbiao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        String sheetName = <span class="string">&quot;教育核定表&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> i,j;</span><br><span class="line"></span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//对第一行进行合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">4</span>));</span><br><span class="line">        <span class="comment">//给第一、二行添值</span></span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;表一&quot;</span>);</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;XXX学校2021年度教育培养、住宿成本生均核定表&quot;</span>);</span><br><span class="line">        <span class="comment">//给第一列添值</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">              <span class="string">&quot;项目&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;一、基本情况&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（一）标准学生数&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（二）教职工&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（三）占地面积&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（四）建筑面积&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;二、成本构成&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（一）人员支出&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（二）租赁费&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（三）财务费用&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（四）商品和服务支出&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（五）固定资产折旧&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;三、生均成本&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>;i&lt;listLength;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(list1[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;核定数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;教育成本核定数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;住宿成本核定数&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//调整列表的宽</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">33</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>成分分析表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_chengfenfenxibiao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String sheetName = <span class="string">&quot;成本分析表&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line">        <span class="keyword">int</span> i,j;</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;新乡市xxx学校成本分析表&quot;</span>);</span><br><span class="line">        <span class="comment">//老朋友 一系列合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//给合并过的单元格设值</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        row.createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;成本核算结果&quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;项目占比&quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;公充值&quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;是否合理&quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">6</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        row1.createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;下限&quot;</span>);</span><br><span class="line">        row1.createCell(<span class="number">5</span>).setCellValue(<span class="string">&quot;上限&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">        String[] list = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、人员支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、租赁费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、财务费用&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;四、商品和服务支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;五、固定资产折旧&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;六、成本合计&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、高中&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list.length;</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;listLength;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">4</span>).createCell(<span class="number">0</span>).setCellValue(list[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        sheet.getRow(<span class="number">5</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.65-0.75&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">6</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.65-0.75&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">7</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.65-0.75&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">9</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.08-0.12&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">10</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.08-0.12&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">11</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.08-0.12&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">13</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.01-0.05&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">14</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.01-0.05&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">15</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.01-0.05&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">17</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.10-0.20&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">18</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.10-0.20&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">19</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.10-0.20&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">21</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.08-0.15&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">22</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.08-0.15&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">23</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;0.08-0.15&quot;</span>);</span><br><span class="line">        <span class="comment">//设置表的列宽</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">1</span>,<span class="number">256</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">2</span>,<span class="number">256</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>,<span class="number">256</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">5</span>,<span class="number">256</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>,<span class="number">256</span>*<span class="number">17</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>教育核算表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_jiaoyuhesuanbiao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        String sheetName = <span class="string">&quot;教育核定表&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> i,j;</span><br><span class="line"></span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//对第一行进行合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">4</span>));</span><br><span class="line">        <span class="comment">//给第一、二行添值</span></span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;表一&quot;</span>);</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;XXX学校2021年度教育培养、住宿成本生均核定表&quot;</span>);</span><br><span class="line">        <span class="comment">//给第一列添值</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">              <span class="string">&quot;项目&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;一、基本情况&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（一）标准学生数&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（二）教职工&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（三）占地面积&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（四）建筑面积&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;二、成本构成&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（一）人员支出&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（二）租赁费&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（三）财务费用&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;1、小学&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;2、初中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;3、高中&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（四）商品和服务支出&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;（五）固定资产折旧&quot;</span> ,</span><br><span class="line">                      <span class="string">&quot;三、生均成本&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>;i&lt;listLength;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(list1[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;核定数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;教育成本核定数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;住宿成本核定数&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//调整列表的宽</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">33</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>参数表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.file;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minban_canshubiao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> j,i;</span><br><span class="line">        String sheetName = <span class="string">&quot;参数表&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;表：一&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">14</span>));</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;新乡市民办学校教育定价成本监审参数表&quot;</span>);</span><br><span class="line">        <span class="comment">//同理 有一个一系列的合并单元格</span></span><br><span class="line">        <span class="keyword">int</span>[] list1 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;=<span class="number">4</span>;i++)&#123;</span><br><span class="line">            sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,list1[i],list1[i]));</span><br><span class="line">        &#125;</span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        String[] list2 = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;项          目&quot;</span>,<span class="string">&quot;栏次及关系&quot;</span>,<span class="string">&quot;总监审数&quot;</span>,<span class="string">&quot;教育生均监审数&quot;</span>,<span class="string">&quot;住宿生均监审数&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;=<span class="number">4</span>;i++)&#123;</span><br><span class="line">            row.createCell(list1[i]).setCellValue(list2[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        row.createCell(<span class="number">14</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">5</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">8</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">for</span> ( j = <span class="number">1</span>;j&lt;=<span class="number">9</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row1.createCell(j+<span class="number">1</span>).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">2</span>)&#123;</span><br><span class="line">                row1.createCell(j+<span class="number">1</span>).setCellValue(<span class="string">&quot;核增核减数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row1.createCell(j+<span class="number">1</span>).setCellValue(<span class="string">&quot;核定数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//给第一列和备注列添值</span></span><br><span class="line">        String[] list3 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、固定资产利用率&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、教学建筑面积占比&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、住宿建筑面积占比&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、行管分摊率&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;四、教职工占比&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;小学&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;初中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;高中&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;五、平均工资&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;六、招待费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;七、培训费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;八、工会经费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;九、维修费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;十、其它支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;十一、福利费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;十二、&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        String[] list4 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;不得低于80%。&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;均为1正确&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;不得明显高于公办水准（标准120%）&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;标准：小学1：19&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;标准：初中1：13.5&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;标准：高中1：12.5&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;统计局：2019年71027元；2020年72261元；2021年？&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;年收入0.5%&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;人员工资总额的8%&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;人员工资总额的2%&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;不得高于固定资产原值的2%&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;不得高于公用支出（不含维修费）20%&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;人员工资总额的14%&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> list1Length = list3.length;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>;i&lt; list1Length;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">4</span>).createCell(<span class="number">0</span>).setCellValue(list3[i]);</span><br><span class="line">            sheet.getRow(i+<span class="number">4</span>).createCell(<span class="number">1</span>).setCellValue(i+<span class="number">1</span>);</span><br><span class="line">            sheet.getRow(i+<span class="number">4</span>).createCell(<span class="number">14</span>).setCellValue(list4[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//添加几个常数</span></span><br><span class="line"></span><br><span class="line">            sheet.getRow(<span class="number">12</span>).createCell(<span class="number">2</span>).setCellValue(<span class="number">19</span>);</span><br><span class="line">            sheet.getRow(<span class="number">12</span>).createCell(<span class="number">5</span>).setCellValue(<span class="number">19</span>);</span><br><span class="line">            sheet.getRow(<span class="number">12</span>).createCell(<span class="number">8</span>).setCellValue(<span class="number">19</span>);</span><br><span class="line"></span><br><span class="line">            sheet.getRow(<span class="number">13</span>).createCell(<span class="number">2</span>).setCellValue(<span class="number">13.5</span>);</span><br><span class="line">            sheet.getRow(<span class="number">13</span>).createCell(<span class="number">5</span>).setCellValue(<span class="number">13.5</span>);</span><br><span class="line">            sheet.getRow(<span class="number">13</span>).createCell(<span class="number">8</span>).setCellValue(<span class="number">13.5</span>);</span><br><span class="line"></span><br><span class="line">            sheet.getRow(<span class="number">14</span>).createCell(<span class="number">2</span>).setCellValue(<span class="number">12.5</span>);</span><br><span class="line">            sheet.getRow(<span class="number">14</span>).createCell(<span class="number">5</span>).setCellValue(<span class="number">12.5</span>);</span><br><span class="line">            sheet.getRow(<span class="number">14</span>).createCell(<span class="number">8</span>).setCellValue(<span class="number">12.5</span>);</span><br><span class="line">            <span class="comment">//设置表宽</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">24</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2022-3-3"><a href="#2022-3-3" class="headerlink" title="2022/3/3"></a>2022/3/3</h2><p>公办的表都写好了</p>
<p><strong>封面</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.public_schools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">cover</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        String sheetName = <span class="string">&quot;封面&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置民办封面</span></span><br><span class="line">        <span class="comment">//创建一个sheet</span></span><br><span class="line">        <span class="comment">//封面的第一行是空着的</span></span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        XSSFRow xssfRow;</span><br><span class="line">        XSSFCell xssfCell;</span><br><span class="line">        <span class="comment">// 申请第一行 行和列都是从零开始的</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        <span class="comment">//第一行是四个cell</span></span><br><span class="line">        <span class="keyword">for</span> ( i = <span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">            XSSFCell cell = row.createCell(i);</span><br><span class="line">            <span class="comment">//第一行都是空着的 因此我们也把这个值设成空值</span></span><br><span class="line">            cell.setCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//下边编写第二行</span></span><br><span class="line">        <span class="comment">//第二行只用一列</span></span><br><span class="line">        <span class="comment">//设置单元格的合并</span></span><br><span class="line">        CellRangeAddress cellAddresses = <span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses);</span><br><span class="line">        XSSFRow row1 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        XSSFCell cell = row1.createCell(<span class="number">0</span>);</span><br><span class="line">        cell.setCellValue(<span class="string">&quot;新乡市民办学校教育定价成本监审表&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//第三行是一个空格行</span></span><br><span class="line">        CellRangeAddress cellAddresses2 = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses2);</span><br><span class="line">        XSSFRow row2 = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        XSSFCell cell1 = row2.createCell(<span class="number">0</span>);</span><br><span class="line">        cell1.setCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">//为第五后的合并单元格</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">3</span>;i&lt;=<span class="number">11</span>;i++)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses4 = <span class="keyword">new</span> CellRangeAddress(i, i, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses4);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//第五航到第12行</span></span><br><span class="line">        String[] name = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;学 校 名 称&quot;</span>,<span class="string">&quot;法 定人 代 表&quot;</span>,<span class="string">&quot;学 校 地 址&quot;</span>,<span class="string">&quot;邮 政 编 码&quot;</span>,<span class="string">&quot;财务负责人&quot;</span>,<span class="string">&quot;填  表  人&quot;</span>,<span class="string">&quot;电     话  &quot;</span>,<span class="string">&quot;邮     箱&quot;</span>,<span class="string">&quot;传     真 &quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">3</span>;i&lt;=<span class="number">11</span>; i++)&#123;</span><br><span class="line">            XSSFRow row4 = sheet.createRow(i);</span><br><span class="line">            XSSFCell cell4 = row4.createCell(<span class="number">1</span>);</span><br><span class="line">            cell4.setCellValue(name[i-<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//第十三行是空格行</span></span><br><span class="line">        sheet.createRow(<span class="number">12</span>);</span><br><span class="line">        <span class="comment">//第十四行</span></span><br><span class="line">        XSSFRow row3 = sheet.createRow(<span class="number">13</span>);</span><br><span class="line">        XSSFCell cell2 = row3.createCell(<span class="number">3</span>);</span><br><span class="line">        cell2.setCellValue(<span class="string">&quot;学校盖章&quot;</span>);</span><br><span class="line">        CellRangeAddress cellAddresses3 = <span class="keyword">new</span> CellRangeAddress(<span class="number">13</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">        sheet.addMergedRegion(cellAddresses3);</span><br><span class="line">        <span class="comment">//第十五行</span></span><br><span class="line"></span><br><span class="line">        XSSFRow row4 = sheet.createRow(<span class="number">14</span>);</span><br><span class="line">        XSSFCell cell3 = row4.createCell(<span class="number">3</span>);</span><br><span class="line">        cell3.setCellValue(<span class="string">&quot;          年&quot;</span>);</span><br><span class="line"></span><br><span class="line">        XSSFCell cell4 = row4.createCell(<span class="number">4</span>);</span><br><span class="line">        cell4.setCellValue(<span class="string">&quot;     月           日&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//一下是对表格的宽度等的优化</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置列宽</span></span><br><span class="line"></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>, <span class="number">258</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">1</span>, <span class="number">258</span>*<span class="number">23</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>, <span class="number">258</span>*<span class="number">13</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>, <span class="number">258</span>*<span class="number">13</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">5</span>, <span class="number">258</span>*<span class="number">28</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置行高</span></span><br><span class="line">        sheet.setDefaultRowHeight((<span class="keyword">short</span>) <span class="number">456</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>基本表1</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.public_schools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sheet01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        String sheetName = <span class="string">&quot;基本情况表1&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置表格的第一行</span></span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;表：一&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置第二行 有一个大的合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;XXX学校住宿定价成本监审学生人数调查表&quot;</span>);</span><br><span class="line">        sheet.createRow(<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;学校名称：（盖章）            &quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//老朋友 一系列的小合并单元格</span></span><br><span class="line">        <span class="comment">//老朋友 一系列合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">1</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">8</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//        又有一系列小的横向合并</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">4</span>;i=i+<span class="number">2</span>)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">3</span>, i+<span class="number">2</span>, i+<span class="number">3</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//添值</span></span><br><span class="line">        sheet.createRow(<span class="number">3</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;项          目&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;栏次及关系&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">8</span>).setCellValue(<span class="string">&quot;总监审数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">6</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j&lt;<span class="number">6</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row.createCell(j+<span class="number">2</span>).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row.createCell(j+<span class="number">2</span>).setCellValue(<span class="string">&quot;核定数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//设置第一列的值</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、规模房间数（间）&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;6人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;8人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;10人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、规模人数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;6人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;8人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;10人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;四、实际房间数（间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;6人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;8人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;10人/间&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;五、实际在校平均学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;六、实际在校平均住宿标准学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">1</span>; h &lt;= listLength;h++)&#123;</span><br><span class="line">            sheet.createRow(h+<span class="number">4</span>).createCell(<span class="number">0</span>).setCellValue(list1[h-<span class="number">1</span>]);</span><br><span class="line">            sheet.getRow(h+<span class="number">4</span>).createCell(<span class="number">1</span>).setCellValue(h);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//在备注最后有两个合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">17</span>,<span class="number">19</span>,<span class="number">9</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">20</span>,<span class="number">22</span>,<span class="number">9</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.getRow(<span class="number">17</span>).createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;按实际在校学生人数填写。&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">20</span>).createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;按按实际在校住宿学生人数填写。&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置单元格的宽度</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">17</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">2</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">5</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">6</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">7</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">8</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">9</span>,<span class="number">256</span>*<span class="number">17</span>+<span class="number">184</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>基本表2</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.public_schools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sheet02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String sheetName = <span class="string">&quot;基本情况表2&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;表：二&quot;</span>);</span><br><span class="line">        <span class="comment">//编写第二行</span></span><br><span class="line">        <span class="comment">//设置第二行 有一个大的合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;XXX学校住宿定价成本监审学生人数调查表&quot;</span>);</span><br><span class="line">        sheet.createRow(<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;学校名称：（盖章）                                                                                                  单位：人学校名称：（盖章）                                                                                                  单位：人&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//老朋友 一系列的小合并单元格</span></span><br><span class="line">        <span class="comment">//老朋友 一系列合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">1</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">8</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//        又有一系列小的横向合并</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">4</span>;i=i+<span class="number">2</span>)&#123;</span><br><span class="line">            CellRangeAddress cellAddresses1 = <span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>, <span class="number">3</span>, i+<span class="number">2</span>, i+<span class="number">3</span>);</span><br><span class="line">            sheet.addMergedRegion(cellAddresses1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//添值</span></span><br><span class="line">        sheet.createRow(<span class="number">3</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;项          目&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;栏次及关系&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">8</span>).setCellValue(<span class="string">&quot;总监审数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">6</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j&lt;<span class="number">6</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row.createCell(j+<span class="number">2</span>).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row.createCell(j+<span class="number">2</span>).setCellValue(<span class="string">&quot;核定数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//给第一列填值</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、教职工总数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）宿管人员数 &quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）维修人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）其它人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、总建筑面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）教学建筑面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）住宿面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）餐厅面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、固定资产原值&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;四、现执行收费标准&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">1</span>; h &lt;= listLength;h++)&#123;</span><br><span class="line">            sheet.createRow(h+<span class="number">4</span>).createCell(<span class="number">0</span>).setCellValue(list1[h-<span class="number">1</span>]);</span><br><span class="line">            sheet.getRow(h+<span class="number">4</span>).createCell(<span class="number">1</span>).setCellValue(h);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//备注行由合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">6</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">9</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">6</span>).createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;其它人员：指保洁、保安等。此表格视情况而定，一般情况下不申报，特殊情况下可以研究。&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">13</span>).createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;单位：万元&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">14</span>).createCell(<span class="number">9</span>).setCellValue(<span class="string">&quot;单位：元/生.年&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">17</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">2</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">5</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">6</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">7</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">8</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">184</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">9</span>,<span class="number">256</span>*<span class="number">17</span>+<span class="number">184</span>);</span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>基本表3</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.public_schools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sheet03</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String sheetName = <span class="string">&quot;三年相关科目调查表3&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;表三&quot;</span>);</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">10</span>));</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;新乡市xxx学校财政审核后账册中相关科目基本情况表&quot;</span>);</span><br><span class="line">        <span class="comment">//创建我们的老朋友 一系列小合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.createRow(<span class="number">2</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">7</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j&lt;=<span class="number">9</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">2</span>)&#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;核增核减数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;审定数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建第一列</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、人员支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）宿管人员数 &quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）维修人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）其它人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、公用支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、维修费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、水费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、电费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、垃圾清运费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;6、其它费用&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、合计&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">1</span>;i&lt;=listLength;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">3</span>).createCell(<span class="number">0</span>).setCellValue(list1[i-<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">5</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">1</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">6</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">1</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">7</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">5</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">10</span>));</span><br><span class="line">        sheet.getRow(<span class="number">5</span>).createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;提供三类人员工资表&quot;</span>);</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">8</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">10</span>));</span><br><span class="line">        sheet.getRow(<span class="number">8</span>).createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;根据实际情况，可增加科目或另行加行。&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置单元格的宽度</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">14</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">1</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">2</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">5</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">6</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">7</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">8</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">9</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">10</span>,<span class="number">256</span>*<span class="number">14</span>+<span class="number">186</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>基本表4</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.public_schools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sheet04</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String sheetName = <span class="string">&quot;三年账册相关科目表4&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line">        <span class="comment">//设置第一行第一列</span></span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;表：四&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">10</span>));</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;新乡市xxx学校账册相关科目基本情况调查表&quot;</span>);</span><br><span class="line">        <span class="comment">//老朋友来喽 一系列合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">        sheet.createRow(<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;科目&quot;</span>);</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">9</span>));</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">7</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line">        sheet.createRow(<span class="number">3</span>).createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line">        XSSFRow row = sheet.getRow(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j&lt;=<span class="number">9</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;凭证类型&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">2</span>)&#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;账册号&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;金额&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置第一列</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、维修费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;6、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;7、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;8、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;9、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;10、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、其它支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;6、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;7、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;8、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;9、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;10、&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ;i&lt;= listLength;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">3</span>).createCell(<span class="number">0</span>).setCellValue(list1[i-<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//设置合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">4</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">10</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">15</span>,<span class="number">25</span>,<span class="number">10</span>,<span class="number">10</span>));</span><br><span class="line">        sheet.getRow(<span class="number">4</span>).createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;1、统计大于该科目金额20%的明细。2、凭证类型填写发票、合同（协议）、白条（收据）&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">15</span>).createCell(<span class="number">10</span>).setCellValue(<span class="string">&quot;1、如果金额大于公用支出20%，请按内容分类。 如果金额小于公用支出20%，不填写。2、凭证类型填写发票、合同（协议）、白条（收据）&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">1</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">2</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">6</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">7</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">8</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">9</span>,<span class="number">256</span>*<span class="number">10</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">10</span>,<span class="number">256</span>*<span class="number">12</span>+<span class="number">186</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>附表1</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.public_schools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sheet05</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        String sheetName = <span class="string">&quot;住宿成本调查核算表&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;附件1&quot;</span>);</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">14</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">14</span>));</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;XXXXXX生均教育价格成本调查核算表&quot;</span>);</span><br><span class="line">        sheet.createRow(<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;学校名称：（盖章）                                                                                        单位：元                                &quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//啊哈哈哈 一系列合并单元格来喽~~~</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">1</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">11</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">14</span>));</span><br><span class="line">        sheet.createRow(<span class="number">3</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;项       目&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;栏次及关系&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">11</span>).setCellValue(<span class="string">&quot;2021年度成本费用核定数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">14</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">10</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">3</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">13</span>));</span><br><span class="line"></span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">5</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">8</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">3</span>).createCell(<span class="number">12</span>).setCellValue(<span class="string">&quot;2021年度住宿成本核定数&quot;</span>);</span><br><span class="line"></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>;j&lt;=<span class="number">10</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;核增核减数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">2</span>)&#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;审定数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        row.createCell(<span class="number">12</span>).setCellValue(<span class="string">&quot;住宿成本&quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">13</span>).setCellValue(<span class="string">&quot;生均结论&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置第一列</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、人员支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）宿管人员数 &quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）维修人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）其它人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、公用支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、维修费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、水费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、电费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、垃圾清运费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;6、其它费用&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;十二、生均合计&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;listLength;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">5</span>).createCell(<span class="number">0</span>).setCellValue(list1[i]);</span><br><span class="line">            sheet.getRow(i+<span class="number">5</span>).createCell(<span class="number">1</span>).setCellValue(i+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">5</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">13</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">9</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">13</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">10</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">14</span>));</span><br><span class="line">        sheet.getRow(<span class="number">10</span>).createCell(<span class="number">14</span>).setCellValue(<span class="string">&quot;按建筑面积比进行分摊&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建列表的宽</span></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">13</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">11</span>+<span class="number">186</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>附表2</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.public_schools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sheet06</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line">        String sheetName = <span class="string">&quot;住宿成本报告核定表&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">4</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">        sheet.createRow(<span class="number">0</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;表一&quot;</span>);</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;XXX学校2021年度住宿成本生均核定表&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.createRow(<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;项目&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;栏次及关系&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;核定数&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、基本情况&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）标准学生数&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;其中：年初学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;         年末学生数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）宿舍管理人员&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（三）宿舍建筑面积&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（四）标准间（人/间）&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（五）房间数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、成本构成&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（一）人员支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、宿管人员数 &quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、维修人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、其它人员数&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;（二）公用支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;1、维修费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;2、水费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;3、电费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;4、垃圾清运费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;5、&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;6、其它费用&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、生均成本&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;</span><br><span class="line">        <span class="keyword">int</span> i =<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;listLength;i++)&#123;</span><br><span class="line">            sheet.createRow(i+<span class="number">3</span>).createCell(<span class="number">0</span>).setCellValue(list1[i]);</span><br><span class="line">            sheet.getRow(i+<span class="number">3</span>).createCell(<span class="number">1</span>).setCellValue(i+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">19</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">1</span>,<span class="number">256</span>*<span class="number">11</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">2</span>,<span class="number">256</span>*<span class="number">14</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>,<span class="number">256</span>*<span class="number">14</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>,<span class="number">256</span>*<span class="number">14</span>+<span class="number">186</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>附表3</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.public_schools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sheet07</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> XSSFSheet <span class="title">setSheet</span><span class="params">(XSSFWorkbook sheets)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String sheetName = <span class="string">&quot;参数表&quot;</span>;</span><br><span class="line">        XSSFSheet sheet = sheets.createSheet(sheetName);</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">12</span>));</span><br><span class="line">        sheet.createRow(<span class="number">1</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;新乡XXX学校住宿定价成本监审参数表&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//啊哈哈哈 一系列的合并单元格</span></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">11</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">12</span>));</span><br><span class="line"></span><br><span class="line">        sheet.createRow(<span class="number">2</span>).createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;项          目&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;栏次及关系&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">11</span>).setCellValue(<span class="string">&quot;结论&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">12</span>).setCellValue(<span class="string">&quot;备注&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">7</span>));</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">10</span>));</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;2019年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">5</span>).setCellValue(<span class="string">&quot;2020年&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">2</span>).createCell(<span class="number">8</span>).setCellValue(<span class="string">&quot;2021年&quot;</span>);</span><br><span class="line"></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>;j&lt;=<span class="number">10</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;申报数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (j%<span class="number">3</span> == <span class="number">2</span>)&#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;核增核减数&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                row.createCell(j).setCellValue(<span class="string">&quot;审定数&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建第一列</span></span><br><span class="line">        String[] list1 = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">                <span class="string">&quot;一、固定资产利用率&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;二、住宿建筑面积占比&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;三、住宿学生占比&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;四、维修费&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;五、其它支出&quot;</span> ,</span><br><span class="line">                        <span class="string">&quot;六、&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> listLength = list1.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= listLength;j++)&#123;</span><br><span class="line"></span><br><span class="line">            sheet.createRow(j+<span class="number">3</span>).createCell(<span class="number">0</span>).setCellValue(list1[j-<span class="number">1</span>]);</span><br><span class="line">            sheet.getRow(j+<span class="number">3</span>).createCell(<span class="number">1</span>).setCellValue(j);</span><br><span class="line">        &#125;</span><br><span class="line">        sheet.getRow(<span class="number">4</span>).createCell(<span class="number">12</span>).setCellValue(<span class="string">&quot;不得低于80%。&quot;</span>);</span><br><span class="line">        sheet.getRow(<span class="number">7</span>).createCell(<span class="number">12</span>).setCellValue(<span class="string">&quot;不得高于固定资产原值的2%&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sheet.setColumnWidth(<span class="number">0</span>,<span class="number">256</span>*<span class="number">15</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">2</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">3</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">4</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">5</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">6</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">7</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">8</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">9</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">10</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">11</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line">        sheet.setColumnWidth(<span class="number">12</span>,<span class="number">256</span>*<span class="number">9</span>+<span class="number">186</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-SpringMVC前后端的结合"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/02/22/SpringMVC%E5%89%8D%E5%90%8E%E7%AB%AF%E7%9A%84%E7%BB%93%E5%90%88/"
    >SSM框架下的项目前后端的结合</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/02/22/SpringMVC%E5%89%8D%E5%90%8E%E7%AB%AF%E7%9A%84%E7%BB%93%E5%90%88/" class="article-date">
  <time datetime="2022-02-22T14:18:14.981Z" itemprop="datePublished">2022-02-22</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="SSM框架下的项目前后端的结合"><a href="#SSM框架下的项目前后端的结合" class="headerlink" title="SSM框架下的项目前后端的结合"></a>SSM框架下的项目前后端的结合</h1><p>对于前后端结合莫非两个步骤：</p>
<ul>
<li>编写对应的Controller层</li>
<li>编写前端</li>
</ul>
<h2 id="查询书籍功能的实现"><a href="#查询书籍功能的实现" class="headerlink" title="查询书籍功能的实现"></a>查询书籍功能的实现</h2><p><strong>编写controller层</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">package com.dwx.controller;</span><br><span class="line"></span><br><span class="line">import com.dwx.pojo.Books;</span><br><span class="line">import com.dwx.service.BooksService;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.ui.Model;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">//此处我们使用注解开发</span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping(&quot;/books&quot;)</span><br><span class="line">public class BooksController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private BooksService booksService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //对于Controller层 他的工作是调用Service层，因此将service作为参数</span><br><span class="line">    @RequestMapping(&quot;allBooks&quot;)</span><br><span class="line">    public String queryAllBooks(Model model)&#123;</span><br><span class="line">        List&lt;Books&gt; books = booksService.queryBooks();</span><br><span class="line">        model.addAttribute(&quot;books&quot;,books);</span><br><span class="line">        return &quot;books&quot;;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>编写前端代码</strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">&lt;%--</span><br><span class="line">  Created by IntelliJ IDEA.</span><br><span class="line">  User: Lenovo</span><br><span class="line">  Date: <span class="number">2022</span>/<span class="number">2</span>/<span class="number">22</span></span><br><span class="line">  Time: <span class="number">20</span>:<span class="number">25</span></span><br><span class="line">  To change <span class="keyword">this</span> template use File | Settings | File Templates.</span><br><span class="line">--%&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;查询书籍页面&lt;/title&gt;</span><br><span class="line">    &lt;!-- 引入 Bootstrap --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;table&gt;</span><br><span class="line">        &lt;thead&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;th&gt;书籍编号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;书籍名称&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;书籍数目&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;书籍细节&lt;/th&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/thead&gt;</span><br><span class="line">        &lt;tbody&gt;</span><br><span class="line">            &lt;c:forEach <span class="keyword">var</span>=<span class="string">&quot;book&quot;</span>  items=<span class="string">&quot;$&#123;books&#125;&quot;</span>&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;$&#123;book.bookID&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;book.bookName&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;book.bookCounts&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;book.detail&#125;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/c:forEach&gt;</span><br><span class="line">        &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其他的功能都是类似操作，不再进行展示</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-SpringMVCSSM框架的整合"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/02/21/SpringMVCSSM%E6%A1%86%E6%9E%B6%E7%9A%84%E6%95%B4%E5%90%88/"
    >SSM框架的整合</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/02/21/SpringMVCSSM%E6%A1%86%E6%9E%B6%E7%9A%84%E6%95%B4%E5%90%88/" class="article-date">
  <time datetime="2022-02-21T14:56:39.214Z" itemprop="datePublished">2022-02-21</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="SSM框架的整合"><a href="#SSM框架的整合" class="headerlink" title="SSM框架的整合"></a>SSM框架的整合</h1><p><strong>我的学习博客：</strong> <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/SDxqGu_il3MUCTcN1EYrng">狂神说SpringMVC05：整合SSM框架 (qq.com)</a> </p>
<p>我是根据这个博客学的</p>
<p>说是SSM框架的整合，其实还是重新创建一个项目，正好学习从0开始写一个项目的方法。</p>
<h2 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h2><ul>
<li>IDEA</li>
<li>maven 3.6（以上）</li>
<li>Tomact9 （以下）</li>
<li>MySQL 5.7（以上）</li>
</ul>
<h2 id="第一步，分析需求设计数据库"><a href="#第一步，分析需求设计数据库" class="headerlink" title="第一步，分析需求设计数据库"></a>第一步，分析需求设计数据库</h2><p>我们这里仅仅创建一个非常简单ed图书管理系统，创建一个非常简单的数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE ssmbuild;</span><br><span class="line">USE ssmbuild;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `books`(</span><br><span class="line">`bookID` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;书id&#x27;</span>,</span><br><span class="line">`bookName` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;书名&#x27;</span>,</span><br><span class="line">`bookCounts` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;数量&#x27;</span>,</span><br><span class="line">`detail` <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;描述&#x27;</span>,</span><br><span class="line">KEY `bookID`(`bookID`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `books`(`bookID`,`bookName`,`bookCounts`,`detail`)<span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>,<span class="string">&#x27;Java&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;从入门到放弃&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&#x27;MySQL&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;从删库到跑路&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&#x27;Linux&#x27;</span>,<span class="number">5</span>,<span class="string">&#x27;从进门到进牢&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p> <img src="https://s3.bmp.ovh/imgs/2022/02/c6a8befd93036816.jpg" alt="数据库样貌"> </p>
<h2 id="第二步，创建javaweb项目"><a href="#第二步，创建javaweb项目" class="headerlink" title="第二步，创建javaweb项目"></a>第二步，创建javaweb项目</h2><p> <img src="https://s3.bmp.ovh/imgs/2022/02/acdf6ff47d83424a.jpg"> </p>
<p>修改web.xml文件中的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/j2ee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;2.4&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="第三步，导入环境依赖"><a href="#第三步，导入环境依赖" class="headerlink" title="第三步，导入环境依赖"></a>第三步，导入环境依赖</h2><p>包括;</p>
<ul>
<li>junit</li>
<li>数据驱动和连接池</li>
<li>servlet</li>
<li>jsp</li>
<li>mybatis</li>
<li>mybatis-Spring</li>
<li>Spring的一系列包</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.46<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>有提示<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>并且顺手处理了可能存在的mybatis环境不仅如此target问题：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="第四步，链接数据库"><a href="#第四步，链接数据库" class="headerlink" title="第四步，链接数据库"></a>第四步，链接数据库</h2><p> <img src="https://s3.bmp.ovh/imgs/2022/02/a07ff9a7efeb82f7.jpg" alt="连接数据库"> </p>
<h2 id="第五步，编写包结构"><a href="#第五步，编写包结构" class="headerlink" title="第五步，编写包结构"></a>第五步，编写包结构</h2><p>我们创建一个程序，最基础的包结构有：</p>
<ul>
<li>Mapper（永久层）</li>
<li>POJO（实体类）</li>
<li>service</li>
<li>Controller（原 servlet）</li>
</ul>
<p>以及在resource下创建;</p>
<ul>
<li>mybatis-config.xml（mybatis的核心配置文件）</li>
<li>applicationContext.xml（Spring的核心配置文件）</li>
</ul>
<p>并导入他们的配置头文件</p>
<p> <img src="https://s3.bmp.ovh/imgs/2022/02/e8a1d7dcaca391e5.jpg" alt="完整的包结构"> </p>
<p><strong>mybatis-config.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>applicationContext.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第六步，mybatis关联数据库"><a href="#第六步，mybatis关联数据库" class="headerlink" title="第六步，mybatis关联数据库"></a>第六步，mybatis关联数据库</h2><p>在resource下创建db.properties文件，并且写入链接数据库所需的一切参数</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver</span> = <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span> = <span class="string">jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;characterEnconding=utf8&amp;useSSL=true</span></span><br><span class="line"><span class="attr">username</span> = <span class="string">dwx</span></span><br><span class="line"><span class="attr">password</span> = <span class="string">123456</span></span><br></pre></td></tr></table></figure>

<p>本身是需要在mybatis中关联的，但是由于我们使用Spring整合了mybatis，这部分内容就不需要mybatis做了，mybatis只需要对别名进行处理，或者注册mapper.xml</p>
<p><strong>此时的mybatis-config.xml文件</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--联结数据库的工作交给Spring--&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--使用别名 对实体类使用别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.dwx.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注册mapper.xml--&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="第七步，编写pojo类"><a href="#第七步，编写pojo类" class="headerlink" title="第七步，编写pojo类"></a>第七步，编写pojo类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Books</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>  bookID;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> bookCounts;</span><br><span class="line">    <span class="keyword">private</span> String detail;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Books</span><span class="params">(<span class="keyword">int</span> bookID, String bookName, <span class="keyword">int</span> bookCounts, String detail)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bookID = bookID;</span><br><span class="line">        <span class="keyword">this</span>.bookName = bookName;</span><br><span class="line">        <span class="keyword">this</span>.bookCounts = bookCounts;</span><br><span class="line">        <span class="keyword">this</span>.detail = detail;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Books</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBookID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookID;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBookID</span><span class="params">(<span class="keyword">int</span> bookID)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bookID = bookID;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getBookName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBookName</span><span class="params">(String bookName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bookName = bookName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBookCounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookCounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBookCounts</span><span class="params">(<span class="keyword">int</span> bookCounts)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bookCounts = bookCounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDetail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> detail;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDetail</span><span class="params">(String detail)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.detail = detail;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Books&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;bookID=&quot;</span> + bookID +</span><br><span class="line">                <span class="string">&quot;, bookName=&#x27;&quot;</span> + bookName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, bookCounts=&quot;</span> + bookCounts +</span><br><span class="line">                <span class="string">&quot;, detail=&#x27;&quot;</span> + detail + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>此处我们没有使用注解开发，如果使用注解就要导入Lombok的·包，</p>
<p>具体过程如这篇博客： <a target="_blank" rel="noopener" href="https://dwx-tx.github.io/2022/01/12/mybatis%E4%BB%8B%E7%BB%8DLombok%E6%8F%92%E4%BB%B6/">Lombok插件的使用 | dwx-tx的小天地</a> </p>
<p><strong>要求：</strong>实体类的参数的类型的名字要与数据库中的一致。</p>
<h2 id="第八步，接口实现操作"><a href="#第八步，接口实现操作" class="headerlink" title="第八步，接口实现操作"></a>第八步，接口实现操作</h2><p>在Dao层创建接口，写出预计的操作。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dwx.pojo.Books;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.print.Book;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BooksMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接口实现操作</span></span><br><span class="line">    <span class="comment">//增加书籍操作</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addBook</span><span class="params">(Books books)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除书籍操作：通过ID</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteBook</span><span class="params">(<span class="meta">@Param(&quot;bookID&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改图书信息</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateBook</span><span class="params">(Books books)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询书籍byID</span></span><br><span class="line">    <span class="function">Books <span class="title">queryBook</span><span class="params">(<span class="meta">@Param(&quot;bookID&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询所有的数据</span></span><br><span class="line">    <span class="function">List&lt;Books&gt; <span class="title">queryBooks</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>此处使用<code>@Param(&quot;&quot;)</code>表示以后参数可以使用别名</p>
<h2 id="第九步，编写实现Mapper"><a href="#第九步，编写实现Mapper" class="headerlink" title="第九步，编写实现Mapper"></a>第九步，编写实现Mapper</h2><p>此时就用到Mybatis了，在Mapper层下创造一个和接口同名的xml文件，并且导入Mapper配置。</p>
<p>修改<code>&lt;mapper&gt;&lt;/mapper&gt;</code>的命名空间为接口的名字</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.dwx.mapper.BooksMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>编写SQL，实现sql</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.dwx.mapper.BooksMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--增加书籍操作--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addBook&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">        insert into ssmbuild.books (bookName,bookCounts,detail)</span><br><span class="line">        VALUES #&#123;bookName&#125;,#&#123;bookCounts&#125;,#&#123;detai&#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--删除书籍操作--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteBook&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        delete from ssmbuild.books</span><br><span class="line">        where bookID = #&#123;bookID&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--修改图书信息--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateBook&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">        update ssmbuild.books</span><br><span class="line">        set bookName = #&#123;bookName&#125;,bookCounts = #&#123;bookCounts&#125;,detail = #&#123;detail&#125;</span><br><span class="line">        where bookID = #&#123;bookID&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--查询书籍ByID--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBook&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">        select * from ssmbuild.books where bookID = #&#123;bookID&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--查询所有的书籍--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBooks&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">        select * from ssmbuild.books;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>实现的xml编写完后，要迅速到mybatis-config.xml中进行配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--联结数据库的工作交给Spring--&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--使用别名 对实体类使用别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.dwx.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注册mapper.xml--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.dwx.mapper.BooksMapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="第十步，编写service层（接口加实现类）"><a href="#第十步，编写service层（接口加实现类）" class="headerlink" title="第十步，编写service层（接口加实现类）"></a>第十步，编写service层（接口加实现类）</h2><p>service层的唯一作用就是链接DAO层，将数据传递到Controller层，因此，在service层中需要调用DAO层（引用这个层）</p>
<p><strong>接口</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dwx.pojo.Books;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BooksService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//service层做得工作和Dao层差不多</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addBook</span><span class="params">(Books books)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除书籍操作：通过ID</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteBook</span><span class="params">(<span class="meta">@Param(&quot;bookID&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改图书信息</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateBook</span><span class="params">(Books books)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询书籍byID</span></span><br><span class="line">    <span class="function">Books <span class="title">queryBook</span><span class="params">(<span class="meta">@Param(&quot;bookID&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询所有的数据</span></span><br><span class="line">    <span class="function">List&lt;Books&gt; <span class="title">queryBooks</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>实现类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dwx.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dwx.mapper.BooksMapper;</span><br><span class="line"><span class="keyword">import</span> com.dwx.pojo.Books;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title">BooksService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//调用DAO层</span></span><br><span class="line">    <span class="keyword">private</span> BooksMapper booksMapper;</span><br><span class="line">    <span class="comment">//由于是使用mybatis，因此一定要使用set方法，因为mybatis是支持set注入的</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBooksMapper</span><span class="params">(BooksMapper booksMapper)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.booksMapper = booksMapper;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//此时使用这个mapper对象就能实现操作了</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addBook</span><span class="params">(Books books)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> booksMapper.addBook(books);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteBook</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> booksMapper.deleteBook(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">updateBook</span><span class="params">(Books books)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> booksMapper.updateBook(books);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Books <span class="title">queryBook</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> booksMapper.queryBook(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Books&gt; <span class="title">queryBooks</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> booksMapper.queryBooks();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第十一步，整合Spring"><a href="#第十一步，整合Spring" class="headerlink" title="第十一步，整合Spring"></a>第十一步，整合Spring</h2><p>spring能够整合每一层，并且在每一层都创建一个xml</p>
<h3 id="Spring整合DAO层"><a href="#Spring整合DAO层" class="headerlink" title="Spring整合DAO层"></a>Spring整合DAO层</h3><p>创建SpringDAO/mapper.xml并且导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>对于这个xml要做到的功能如下：</p>
<ul>
<li><p>关联数据库配置文件</p>
</li>
<li><p>链接池</p>
</li>
<li><p>SqlSessionFactory</p>
</li>
<li><p>将DAO接口注入到Spring容器中</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--关联数据库配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:db.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--连接池--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--这个c3j0数据库源有问题，我们使用我们Mybatis默认的数据源--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&amp;lt;!&amp;ndash;    这里我们使用的链接池是c3j0&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;bean id=&quot;dataSource&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;driverClass&quot; value=&quot;$&#123;driver&#125;&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;password&quot; value=&quot;$&#123;password&#125;&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;user&quot; value=&quot;$&#123;username&#125;&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;jdbcUrl&quot; value=&quot;$&#123;url&#125;&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash;对这个连接池进行一点个性化配置&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash; c3p0连接池的私有属性 &amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;maxPoolSize&quot; value=&quot;30&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;minPoolSize&quot; value=&quot;10&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash; 关闭连接后不自动commit &amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;autoCommitOnClose&quot; value=&quot;false&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash; 获取连接超时时间 &amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;checkoutTimeout&quot; value=&quot;10000&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash; 当获取连接失败重试次数 &amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;acquireRetryAttempts&quot; value=&quot;2&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/bean&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--整合数据库 数据源--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis的默认数据库池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useUnicode=true<span class="symbol">&amp;amp;</span>characterEnconding=utf8<span class="symbol">&amp;amp;</span>useSSL=truejdbc:mysql://localhost:3306/mybatis?useUnicode=true<span class="symbol">&amp;amp;</span>characterEnconding=utf8<span class="symbol">&amp;amp;</span>useSSL=true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;dwx&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--sqlSessionFactory--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--链接数据源--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--绑定mybatis配置文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置永久层扫描包（动态的实现DAO接口可以注入到Spring容器中）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--注入SQLSessionFactory--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置要扫描的包--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.dwx.mapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Spring整合service层"><a href="#Spring整合service层" class="headerlink" title="Spring整合service层"></a>Spring整合service层</h3><p>步奏：</p>
<ul>
<li>扫描service层下的包</li>
<li>在service类上加上@Service表示被Spring托管</li>
<li>将所有的业务类注册到Spring中</li>
<li>声明式事务配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--扫描Service的包--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dwx.service&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--将我们的业务类都朱擦到Spring中--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;BooksServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dwx.service.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Spring注入参数Mapper--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;booksMapper&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;booksMapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--声明式事务配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--绑定数据源--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第十二步，整合SpringMVC"><a href="#第十二步，整合SpringMVC" class="headerlink" title="第十二步，整合SpringMVC"></a>第十二步，整合SpringMVC</h2><p>SpringMVC整合步奏：</p>
<ul>
<li>将web.xml文件换成最新的</li>
<li>配置DispatchServlet</li>
<li>解决乱码</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/j2ee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;2.4&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注册DispatcherServlet及其一些配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Spring<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Spring<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--解决乱码问题--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们看这个配置，有一个<code>classpath:springmvc-servlet.xml</code></p>
<p>这里是我们Spring整合Controller层，我们去编写这个</p>
<p>它要做到的事情：</p>
<ul>
<li>注解驱动</li>
<li>扫描包</li>
<li>静态资源过滤</li>
<li>视图解析器</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span> <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--由于我们时使用的注解开发，因此需要添加配置 扫描要添加注解的包--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dwx.controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--让SpringMVC不处理静态资源--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--这里我们使用下边这个配置代替 添加处理映射器 添加处理适配器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--编写适配视图解析器--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span> <span class="attr">id</span>=<span class="string">&quot;internalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第十三步，将我们写的几个子xml全部导入到Spring的核心配置文件中去"><a href="#第十三步，将我们写的几个子xml全部导入到Spring的核心配置文件中去" class="headerlink" title="第十三步，将我们写的几个子xml全部导入到Spring的核心配置文件中去"></a>第十三步，将我们写的几个子xml全部导入到Spring的核心配置文件中去</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;spring-mapper.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">import</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;spring-service.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">import</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;springmvc-servlet.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">import</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>到此时我们的SSM框架就彻底整合完毕了</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-SpringMVC对于Json的浅薄理解"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/02/20/SpringMVC%E5%AF%B9%E4%BA%8EJson%E7%9A%84%E6%B5%85%E8%96%84%E7%90%86%E8%A7%A3/"
    >对于JSON的浅薄理解</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/02/20/SpringMVC%E5%AF%B9%E4%BA%8EJson%E7%9A%84%E6%B5%85%E8%96%84%E7%90%86%E8%A7%A3/" class="article-date">
  <time datetime="2022-02-20T09:12:07.413Z" itemprop="datePublished">2022-02-20</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="对于JSON的浅薄理解"><a href="#对于JSON的浅薄理解" class="headerlink" title="对于JSON的浅薄理解"></a>对于JSON的浅薄理解</h1><p>后端如果使用java写，后端数据的类型是基本数据类型加上自己创建的应用类型</p>
<p>前端使用的数据类型，并不存在数据类型 没有特定的规定。</p>
<p>前端和后端的数据怎么正确传输？</p>
<p> <img src="https://s3.bmp.ovh/imgs/2022/02/4e34ac4996977102.jpg" alt="JSON的作用"> </p>
<p>json：</p>
<ul>
<li>是一种轻量级的数据交换格式</li>
<li>采用完全独立于编程语言的文本格式</li>
<li>JSON内有键值对的向欧盟和瑟吉欧</li>
</ul>
<p>JSON不是编程语言，是传递数据的格式，，对于JSON的使用，需要JSON的解析工具。</p>
<p>常用的JSON解析工具有两个：JackSon和FastJson</p>
<h2 id="jackSon的使用"><a href="#jackSon的使用" class="headerlink" title="jackSon的使用"></a>jackSon的使用</h2><p>这里我们依旧采用应用的方式来讲解：</p>
<p>JSON的方法经常用的就是把java转化成String然后传递给前端。</p>
<p>使用JackSon需要导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>创建一个SpringMVC程序，过程如这篇博客： <a target="_blank" rel="noopener" href="https://dwx-tx.github.io/2022/02/19/SpringMVCHelloSpringMVC/">HelloSpringMVC | dwx-tx的小天地</a> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br></pre></td></tr></table></figure>

<p>这就能保证return 不再是重定向，而是将值返回到前端。</p>
<p>这就不难解释，我在写自己的项目的时候，能够将文件直接返回到前端。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">JackSon</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">       User user = <span class="keyword">new</span> User(<span class="string">&quot;dwx&quot;</span>, <span class="number">1900</span>, <span class="number">19</span>);</span><br><span class="line">       <span class="keyword">return</span> user.toString();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>json的基本原理就是将对象转化成一个字符串然后返回到去前端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/h1&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">JackSon</span><span class="params">(Model model)</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line"></span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="string">&quot;dwx&quot;</span>, <span class="number">1900</span>, <span class="number">19</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用JSON</span></span><br><span class="line">        ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        String s = mapper.writeValueAsString(user);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>使用JSON，JSON不仅仅可以作用于一个对象，也能作用于LIST</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/h1&quot;)</span></span><br><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">JackSon</span><span class="params">(Model model)</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line"></span><br><span class="line">       User user = <span class="keyword">new</span> User(<span class="string">&quot;dwx&quot;</span>, <span class="number">1900</span>, <span class="number">19</span>);</span><br><span class="line">       User user1 = <span class="keyword">new</span> User(<span class="string">&quot;dwx1&quot;</span>, <span class="number">1900</span>, <span class="number">19</span>);</span><br><span class="line">       User user2 = <span class="keyword">new</span> User(<span class="string">&quot;dwx2&quot;</span>, <span class="number">1900</span>, <span class="number">19</span>);</span><br><span class="line"></span><br><span class="line">       List&lt;User&gt; UserList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       UserList.add(user);</span><br><span class="line">       UserList.add(user1);</span><br><span class="line">       UserList.add(user2);</span><br><span class="line">       <span class="comment">//使用JSON</span></span><br><span class="line">       ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">       String s = mapper.writeValueAsString(UserList);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> s;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h2 id="JSON中文乱码问题"><a href="#JSON中文乱码问题" class="headerlink" title="JSON中文乱码问题"></a>JSON中文乱码问题</h2><p>对于JSON的乱码，使用过滤器无法解决这个问题，但是JSON给出了解决方法</p>
<p><strong>使用注解解决</strong></p>
<p>在<code>@RequestMappering</code>中有一个<code>produces</code>属性，我们可以通过这个属性来实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/h1&quot;,produces = &quot;application/json;charset-utf-8&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">JackSon</span><span class="params">(Model model)</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line"></span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="string">&quot;党文轩&quot;</span>, <span class="number">1900</span>, <span class="number">19</span>);</span><br><span class="line">        User user1 = <span class="keyword">new</span> User(<span class="string">&quot;德行1&quot;</span>, <span class="number">1900</span>, <span class="number">19</span>);</span><br><span class="line">        User user2 = <span class="keyword">new</span> User(<span class="string">&quot;等我下&quot;</span>, <span class="number">1900</span>, <span class="number">19</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; UserList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        UserList.add(user);</span><br><span class="line">        UserList.add(user1);</span><br><span class="line">        UserList.add(user2);</span><br><span class="line">        <span class="comment">//使用JSON</span></span><br><span class="line">        ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        String s = mapper.writeValueAsString(UserList);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的问题在于，这个注释可能会重写很多遍，因此SpringMVC提供了在Springxml文件中配置的方法解决这个问题</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;objectMapper&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;failOnEmptyBeans&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>固定格式，不需要做任何的更改</strong></p>
<h2 id="FastJson"><a href="#FastJson" class="headerlink" title="FastJson"></a>FastJson</h2><p>FASTJSON是阿里自己的JSON编译器，但是由于他的功能和我们使用的JackSon差不多，这里我们就不讲了</p>
<p>可以参考这个博客： <a target="_blank" rel="noopener" href="https://blog.csdn.net/codershamo/article/details/51994720?ops_request_misc=&request_id=&biz_id=102&utm_term=fastjson&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-51994720.first_rank_v2_pc_rank_v29&spm=1018.2226.3001.4187"> fastjson的基本使用方法</a> </p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/4/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/6/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2023
        <i class="ri-heart-fill heart_icon"></i> dwx
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="dwx-tx的小天地"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>